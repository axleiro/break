(()=>{"use strict";var e={203:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{u(r.next(e))}catch(e){s(e)}}function c(e){try{u(r.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}u((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,s,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function c(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};t.__esModule=!0;var i=n(681),c=n(880),u=s(n(974)),a=s(n(412)),l=s(n(185)),f=s(n(60)),h=n(593),p=s(n(69)),d="true"===process.env.REQUIRE_PAYMENT,v=function(){function e(){}return e.getFeeCalculator=function(e){return r(this,void 0,void 0,(function(){var t;return o(this,(function(n){switch(n.label){case 0:n.label=1;case 1:return n.trys.push([1,3,,5]),console.log("Connecting to cluster: "+c.url),[4,e.getRecentBlockhash()];case 2:return t=n.sent().feeCalculator,console.log("Connected to cluster: "+c.url),[2,t];case 3:return n.sent(),console.log("Failed to connect to cluster: "+c.url),[4,h.sleep(1e3)];case 4:return n.sent(),[3,5];case 5:return[3,0];case 6:return[2]}}))}))},e.start=function(t,n){return r(this,void 0,void 0,(function(){var s,h,v,b,y,g,w=this;return o(this,(function(m){switch(m.label){case 0:return s=new i.Connection(c.url,"recent"),[4,l.default.create(s)];case 1:return h=m.sent(),p.default.start(n,h),[4,a.default.init(s)];case 2:return v=m.sent(),[4,e.getFeeCalculator(s)];case 3:return b=m.sent(),[4,u.default.load(s,v,b)];case 4:return y=m.sent(),[4,f.default.init(s,v,b,y)];case 5:return g=m.sent(),[4,h.connect()];case 6:return m.sent(),t.post("/accounts",(function(e,t){return r(w,void 0,void 0,(function(){var n,r,s,i,c,u,a,l,f,h;return o(this,(function(o){switch(o.label){case 0:return n=parseInt(e.body.split),r=e.body.paymentKey,s=isNaN(n)?4:Math.max(1,Math.min(10,n)),d&&!r?(t.status(400).send("Payment required"),[2]):[4,g.reserveAccounts(s)];case 1:if(!o.sent())return[3,6];if(!d)return[3,5];o.label=2;case 2:return o.trys.push([2,4,,5]),u=g.calculateCost(s,!1),[4,v.collectPayment(r,u)];case 3:return o.sent(),[3,5];case 4:return a=o.sent(),t.status(400).send("Payment failed: "+a),g.unreserveAccounts(s),[2];case 5:return f=g.popAccounts(s),i=f.programAccounts,c=f.feeAccounts,[3,12];case 6:if(!d)return[3,11];o.label=7;case 7:return o.trys.push([7,9,,10]),[4,g.createAccounts(r,s)];case 8:return h=o.sent(),i=h.programAccounts,c=h.feeAccounts,[3,10];case 9:return l=o.sent(),t.status(400).send("Payment failed: "+l),[2];case 10:return 0===i.length?(t.status(500).send("Failed to create new accounts, try again"),[2]):[3,12];case 11:return t.status(500).send("Account supply depleted, try again"),[2];case 12:return t.send(JSON.stringify({programAccounts:i.map((function(e){return e.publicKey.toBase58()})),feeAccounts:c.map((function(e){return Buffer.from(e.secretKey).toString("base64")})),accountCapacity:g.accountCapacity()})).end(),[2]}}))}))})),t.post("/init",(function(e,t){return r(w,void 0,void 0,(function(){var n,r;return o(this,(function(o){return n=parseInt(e.body.split),r=isNaN(n)?4:Math.max(1,Math.min(32,n)),t.send(JSON.stringify({programId:y.toString(),clusterUrl:c.urlTls,cluster:c.cluster,gameCost:g.calculateCost(r,!0),paymentRequired:d})).end(),[2]}))}))})),[2]}}))}))},e}();t.default=v},59:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{u(r.next(e))}catch(e){s(e)}}function c(e){try{u(r.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}u((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,s,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function c(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}};t.__esModule=!0;var s=n(593),i=function(){function e(t,n){var s=this;this.connection=t,this.nodes=n,this.refreshing=!1,this.refresh=function(){return r(s,void 0,void 0,(function(){var t;return o(this,(function(n){switch(n.label){case 0:return this.refreshing?[2]:(this.refreshing=!0,t=this,[4,e.getAvailableNodes(this.connection)]);case 1:return t.nodes=n.sent(),this.refreshing=!1,[2]}}))}))},setInterval((function(){return s.refresh()}),3e4)}return e.start=function(t){return r(void 0,void 0,void 0,(function(){var n;return o(this,(function(r){switch(r.label){case 0:return[4,e.getAvailableNodes(t)];case 1:return n=r.sent(),[2,new e(t,n)]}}))}))},e.getAvailableNodes=function(e){return r(void 0,void 0,void 0,(function(){var t,n,r,i,c;return o(this,(function(o){switch(o.label){case 0:return t=new Map,[4,s.endlessRetry("getClusterNodes",(function(){return e.getClusterNodes()}))];case 1:for(n=o.sent(),r=0,i=n;r<i.length;r++)(c=i[r]).tpu&&t.set(c.pubkey,c.tpu);return[2,t]}}))}))},e}();t.default=i},412:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{u(r.next(e))}catch(e){s(e)}}function c(e){try{u(r.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}u((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,s,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function c(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}};t.__esModule=!0;var s=n(681),i=n(593),c=process.env.ENCODED_PAYER_KEY,u=10*s.LAMPORTS_PER_SOL,a=function(){function e(e,t,n){this.connection=e,this.feeAccount=t,this.airdropEnabled=n,this.checkingBalance=!1}return e.prototype.address=function(){return this.feeAccount.publicKey},e.init=function(t){return r(this,void 0,void 0,(function(){var n,r,a,l,f;return o(this,(function(o){switch(o.label){case 0:return n=new s.Account,r=!0,c?(n=new s.Account(Buffer.from(c,"base64")),r=!1,console.log("Faucet address: "+n.publicKey.toBase58()),[3,9]):[3,1];case 1:console.log("Airdrops enabled"),o.label=2;case 2:o.label=3;case 3:return o.trys.push([3,6,,8]),[4,t.requestAirdrop(n.publicKey,u)];case 4:return a=o.sent(),[4,t.confirmTransaction(a,"singleGossip")];case 5:return o.sent(),[3,9];case 6:return l=o.sent(),console.error("Failed to airdrop to faucet",l),[4,i.sleep(1e3)];case 7:return o.sent(),[3,8];case 8:return[3,2];case 9:return(f=new e(t,n,r)).checkBalance(),[2,f]}}))}))},e.prototype.collectPayment=function(e,t){return r(this,void 0,void 0,(function(){var n,r,i,c;return o(this,(function(o){switch(o.label){case 0:return n=new s.Account(Buffer.from(e,"base64")),r=n.publicKey,i=this.address(),c=(new s.Transaction).add(s.SystemProgram.transfer({fromPubkey:r,toPubkey:i,lamports:t})),[4,s.sendAndConfirmTransaction(this.connection,c,[n],{commitment:"singleGossip",preflightCommitment:"singleGossip"})];case 1:return o.sent(),this.checkBalance(),[2]}}))}))},e.prototype.checkBalance=function(){return r(this,void 0,void 0,(function(){var e,t,n;return o(this,(function(r){switch(r.label){case 0:if(this.checkingBalance)return[2];this.checkingBalance=!0,r.label=1;case 1:return r.trys.push([1,6,7,8]),[4,this.connection.getBalance(this.feeAccount.publicKey,"singleGossip")];case 2:return e=r.sent(),console.log("Faucet balance: "+e),this.airdropEnabled&&e<=s.LAMPORTS_PER_SOL?[4,this.connection.requestAirdrop(this.feeAccount.publicKey,u)]:[3,5];case 3:return t=r.sent(),[4,this.connection.confirmTransaction(t,"singleGossip")];case 4:r.sent(),r.label=5;case 5:return[3,8];case 6:return n=r.sent(),console.error("failed to check faucet balance",n),[3,8];case 7:return this.checkingBalance=!1,[7];case 8:return[2]}}))}))},e}();t.default=a},607:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};t.__esModule=!0;var o=r(n(127)),s=r(n(605)),i=r(n(479)),c=r(n(622)),u=r(n(203)),a=o.default();void 0!==process.env.FORCE_HTTPS&&a.use((function(e,t,n){"https"!==e.header("x-forwarded-proto")?t.redirect("https://"+e.header("host")+e.url):n()}));var l=c.default.join(__dirname,"..",".."),f=c.default.join(l,"client","build");console.log("Serving static files from: "+f),a.use("/",o.default.static(f)),a.get("/*",(function(e,t){t.sendFile(c.default.join(f,"/index.html"))}));var h=s.default.createServer(a),p=process.env.PORT||8080;h.listen(p),console.log("Server listening on port: "+p),process.env.DISABLE_API||(a.use(i.default()),a.use(o.default.json()),u.default.start(a,h))},536:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{u(r.next(e))}catch(e){s(e)}}function c(e){try{u(r.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}u((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,s,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function c(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}};t.__esModule=!0;var s=n(593),i=parseInt(process.env.LEADER_SLOT_FANOUT||"40"),c=parseInt(process.env.LEADER_SLOT_FANOUT||"40"),u=function(){function e(e,t,n,i){var c=this;this.connection=e,this.schedule=t,this.currentEpochFirstSlot=n,this.slotsInEpoch=i,this.refreshing=!1,this.refresh=function(){return r(c,void 0,void 0,(function(){var e,t=this;return o(this,(function(n){switch(n.label){case 0:return this.refreshing?[2]:(this.refreshing=!0,e=this,[4,s.endlessRetry("getLeaderSchedule",(function(){return t.connection.getLeaderSchedule()}))]);case 1:return e.schedule=n.sent(),this.refreshing=!1,[2]}}))}))}}return e.prototype.getUpcomingNodes=function(e){var t=Math.max(0,e-this.currentEpochFirstSlot),n=new Set;for(var r in this.schedule){var o=this.schedule[r].findIndex((function(e){return e>=Math.max(t-c,0)}));o<0?this.schedule[r]=[]:(this.schedule[r]=this.schedule[r].slice(o),this.schedule[r][0]<t+i&&(console.log("include "+r+" for slot "+this.schedule[r][0]+" current slot index: "+t),n.add(r)))}return n},e.prototype.shouldRefresh=function(e){return e-this.currentEpochFirstSlot>=this.slotsInEpoch-20&&(this.currentEpochFirstSlot+=this.slotsInEpoch,!0)},e.start=function(t){return r(void 0,void 0,void 0,(function(){var n,r,i,c;return o(this,(function(o){switch(o.label){case 0:return[4,s.endlessRetry("getEpochInfo",(function(){return t.getEpochInfo()}))];case 1:return n=o.sent(),[4,s.endlessRetry("getLeaderSchedule",(function(){return t.getLeaderSchedule()}))];case 2:return r=o.sent(),i=n.absoluteSlot-n.slotIndex,c=new e(t,r,i,n.slotsInEpoch),t.onSlotUpdate((function(e){"firstShredReceived"===e.type&&c.shouldRefresh(e.slot)&&c.refresh()})),[2,c]}}))}))},e}();t.default=u},974:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{u(r.next(e))}catch(e){s(e)}}function c(e){try{u(r.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}u((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,s,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function c(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};t.__esModule=!0;var i=n(681),c=s(n(622)),u=s(n(747)),a=n(593),l=u.default.promises,f=process.env.ENCODED_PROGRAM_KEY,h=process.env.DEPLOYED_PROGRAM_ADDRESS,p=function(){function e(){}return e.programAccount=function(){return f?new i.Account(Buffer.from(f,"base64")):new i.Account},e.programAddress=function(){return h?new i.PublicKey(h):e.programAccount().publicKey},e.load=function(t,n,s){return r(this,void 0,void 0,(function(){var r,u,f,h,p,d,v,b,y,g;return o(this,(function(o){switch(o.label){case 0:r=e.programAddress(),u=e.programAccount(),o.label=1;case 1:o.label=2;case 2:return o.trys.push([2,8,,10]),[4,t.getParsedAccountInfo(r)];case 3:return(null==(f=o.sent().value)?void 0:f.executable)?[2,r]:(h=100,p=c.default.join(__dirname,"..","..","program","dist","break_solana_program.so"),console.log("Reading "+p+"..."),[4,l.readFile(p)]);case 4:return d=o.sent(),console.log("Loading break solana program..."),b=s.lamportsPerSignature*(i.BpfLoader.getMinNumSignatures(d.length)+h),[4,t.getMinimumBalanceForRentExemption(d.length)];case 5:return v=b+o.sent(),y=new i.Account,[4,i.sendAndConfirmTransaction(t,(new i.Transaction).add(i.SystemProgram.transfer({fromPubkey:n.feeAccount.publicKey,toPubkey:y.publicKey,lamports:v})),[n.feeAccount],{commitment:"single",skipPreflight:!0})];case 6:return o.sent(),[4,i.BpfLoader.load(t,y,u,d,i.BPF_LOADER_DEPRECATED_PROGRAM_ID)];case 7:return o.sent(),console.log("Program Loaded"),[3,11];case 8:return g=o.sent(),console.error("Failed to load program",g),[4,a.sleep(1e3)];case 9:return o.sent(),[3,10];case 10:return[3,1];case 11:return[2,u.publicKey]}}))}))},e}();t.default=p},288:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{u(r.next(e))}catch(e){s(e)}}function c(e){try{u(r.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}u((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,s,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function c(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};t.__esModule=!0,t.TX_PER_ACCOUNT=void 0;var i=n(681),c=n(593),u=n(669),a=s(n(742)),l=process.env.LIVE?2:10,f=parseInt(process.env.CREATE_ACCOUNT_BATCH_SIZE||"")||l;t.TX_PER_ACCOUNT=parseInt(process.env.TX_PER_ACCOUNT||"")||1e3;var h=function(){function e(e,t,n){this.name=e,this.faucetAccount=t,this.createAccount=n,this.funded=[],this.reserved=[],this.replenishing=!1;var r=process.env.REDIS_URL;r&&(console.log(this.name,"Connecting to",r),this.client=a.default.createClient({url:r})),this.replenish()}return e.calculateRent=function(e,t){return r(this,void 0,void 0,(function(){var n,r,s,i,c,u;return o(this,(function(o){switch(o.label){case 0:return[4,e.getMinimumBalanceForRentExemption(t)];case 1:return n=o.sent(),[4,e.getEpochSchedule()];case 2:return r=o.sent().slotsPerEpoch,i=(s=78894e3/r)/(365.25/7),c=Math.round(2*n/(2*s)),u=Math.max(i,2),[2,Math.ceil(c*u)]}}))}))},e.prototype.pushAccount=function(e){var t=e[0],n=e[1];return r(this,void 0,void 0,(function(){var e,r,s;return o(this,(function(o){switch(o.label){case 0:return this.client?(e=Buffer.from(t.secretKey).toString("base64"),r=n.getTime(),s=JSON.stringify({key:e,expiry:r}),[4,u.promisify(this.client.rpush).bind(this.client,this.name,s)()]):[3,2];case 1:return o.sent(),[3,3];case 2:this.funded.push([t,n]),o.label=3;case 3:return[2]}}))}))},e.prototype.popAccount=function(){return r(this,void 0,void 0,(function(){var e,t,n,r,s,c,a;return o(this,(function(o){switch(o.label){case 0:if(!this.client)return[3,4];o.label=1;case 1:return[4,u.promisify(this.client.lpop).bind(this.client,this.name)()];case 2:return null===(e=o.sent())?[2,void 0]:(t=JSON.parse(e),n=t.key,(r=t.expiry)<Date.now()?[3,1]:[2,[c=new i.Account(Buffer.from(n,"base64")),new Date(r)]]);case 3:return[3,5];case 4:if((s=this.funded.shift())&&(c=s[0],(a=s[1])>=new Date))return[2,[c,a]];o.label=5;case 5:return[2]}}))}))},e.prototype.size=function(){return r(this,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return this.client?[4,u.promisify(this.client.llen).bind(this.client,this.name)()]:[3,2];case 1:return[2,e.sent()];case 2:return[2,this.funded.length]}}))}))},e.prototype.replenish=function(){return r(this,void 0,void 0,(function(){var e,t,n,r,s,i,u,a,l,h;return o(this,(function(o){switch(o.label){case 0:if(this.replenishing)return[2];this.replenishing=!0,o.label=1;case 1:return o.trys.push([1,14,15,16]),[4,this.size()];case 2:e=o.sent(),t=3,o.label=3;case 3:return e<50&&t>0?(t--,n=Math.min(50-e,f),[4,this.createBatch(this.faucetAccount,n)]):[3,13];case 4:r=o.sent(),s=r.length<n,i=0,u=r,o.label=5;case 5:return i<u.length?(a=u[i],(l=new Date).setDate(l.getDate()+7),[4,this.pushAccount([a,l])]):[3,8];case 6:o.sent(),o.label=7;case 7:return i++,[3,5];case 8:return[4,this.size()];case 9:return e=o.sent(),console.log(this.name+": "+e),s?[4,c.sleep(5e3)]:[3,11];case 10:return o.sent(),[3,12];case 11:t=3,o.label=12;case 12:return[3,3];case 13:return[3,16];case 14:return h=o.sent(),console.error("Error replenishing supply",h),[3,16];case 15:return this.replenishing=!1,[7];case 16:return[2]}}))}))},e.prototype.createBatch=function(e,t){return r(this,void 0,void 0,(function(){var n,s,i,c,u,a=this;return o(this,(function(l){switch(l.label){case 0:return n=[],[4,Promise.all(Array(t).fill(0).map((function(){return r(a,void 0,void 0,(function(){var t;return o(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.createAccount(e)];case 1:return[2,n.sent()];case 2:return t=n.sent(),console.error("Failed to replenish account supply",t),[2,void 0];case 3:return[2]}}))}))})))];case 1:for(s=l.sent(),i=0,c=s;i<c.length;i++)void 0!==(u=c[i])&&n.push(u);return[2,n]}}))}))},e.prototype.reserve=function(e){return r(this,void 0,void 0,(function(){var t,n,r,s,i,c;return o(this,(function(o){switch(o.label){case 0:t=[],n=0,o.label=1;case 1:return n<e?[4,this.popAccount()]:[3,4];case 2:if(!(r=o.sent()))return[3,4];t.push(r),o.label=3;case 3:return n++,[3,1];case 4:if(!(t.length<e))return[3,9];s=0,i=t,o.label=5;case 5:return s<i.length?(c=i[s],[4,this.pushAccount(c)]):[3,8];case 6:o.sent(),o.label=7;case 7:return s++,[3,5];case 8:return[2,!1];case 9:return this.reserved=this.reserved.concat(t),[2,!0]}}))}))},e.prototype.unreserve=function(e){return r(this,void 0,void 0,(function(){var t,n,r,s;return o(this,(function(o){switch(o.label){case 0:if(this.reserved.length<e)throw new Error("unable to unreserve");t=this.reserved.splice(0,e),n=0,r=t,o.label=1;case 1:return n<r.length?(s=r[n],[4,this.pushAccount(s)]):[3,4];case 2:o.sent(),o.label=3;case 3:return n++,[3,1];case 4:return[2]}}))}))},e.prototype.pop=function(e){if(this.reserved.length<e)throw this.replenish(),new Error("reserve depleted");var t=this.reserved.splice(0,e);return this.replenish(),t.map((function(e){return e[0]}))},e}();t.default=h},167:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return o(t,e),t},i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{u(r.next(e))}catch(e){s(e)}}function c(e){try{u(r.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}u((r=r.apply(e,t||[])).next())}))},c=this&&this.__generator||function(e,t){var n,r,o,s,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function c(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}};t.__esModule=!0;var u=n(681),a=s(n(288)),l=function(){function e(e,t){this.supply=e,this.accountCost=t}return e.create=function(t,n,r){return i(this,void 0,void 0,(function(){var o,s,l,f=this;return c(this,(function(h){switch(h.label){case 0:return[4,a.default.calculateRent(t,0)];case 1:return o=h.sent(),s=r.lamportsPerSignature,l=a.TX_PER_ACCOUNT*(s+o)+o,[2,new e(new a.default("Fee Account Supply",n.feeAccount,(function(e){return i(f,void 0,void 0,(function(){var n;return c(this,(function(r){switch(r.label){case 0:return n=new u.Account,[4,u.sendAndConfirmTransaction(t,(new u.Transaction).add(u.SystemProgram.transfer({fromPubkey:e.publicKey,toPubkey:n.publicKey,lamports:l})),[e],{commitment:"singleGossip",preflightCommitment:"singleGossip"})];case 1:return r.sent(),[2,n]}}))}))})),l+s)]}}))}))},e}();t.default=l},60:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{u(r.next(e))}catch(e){s(e)}}function c(e){try{u(r.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}u((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,s,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function c(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};t.__esModule=!0;var i=n(681),c=n(593),u=s(n(167)),a=s(n(665)),l=n(288),f=function(){function e(e,t,n,s){var c=this;this.connection=e,this.feeCalculator=t,this.feeAccounts=n,this.programAccounts=s,this.accountCapacity=function(){return l.TX_PER_ACCOUNT},this.createAccounts=function(e,t){return r(c,void 0,void 0,(function(){var n,r,s,c,u,a;return o(this,(function(o){switch(o.label){case 0:return n=new i.Account(Buffer.from(e,"base64")),[4,this.connection.getBalance(n.publicKey,"single")];case 1:if(r=o.sent(),s=this.calculateCost(t,!1),this.feeCalculator.lamportsPerSignature+s>r)throw new Error("Insufficient funds");return[4,this.feeAccounts.supply.createBatch(n,t)];case 2:return c=o.sent(),[4,this.programAccounts.supply.createBatch(n,t)];case 3:return u=o.sent(),a=Math.min(c.length,u.length),[2,{feeAccounts:c.slice(0,a),programAccounts:u.slice(0,a)}]}}))}))},this.reserveAccounts=function(e){return r(c,void 0,void 0,(function(){var t;return o(this,(function(n){switch(n.label){case 0:return[4,this.feeAccounts.supply.reserve(e)];case 1:return(t=n.sent())?[4,this.programAccounts.supply.reserve(e)]:[3,3];case 2:t=n.sent(),n.label=3;case 3:return[2,t]}}))}))},this.unreserveAccounts=function(e){c.feeAccounts.supply.unreserve(e),c.programAccounts.supply.unreserve(e)},this.popAccounts=function(e){return{programAccounts:c.programAccounts.supply.pop(e),feeAccounts:c.feeAccounts.supply.pop(e)}}}return e.prototype.calculateCost=function(e,t){return(t?this.feeCalculator.lamportsPerSignature:0)+e*(this.programAccounts.accountCost+this.feeAccounts.accountCost)},e.init=function(t,n,s,i){return r(void 0,void 0,void 0,(function(){var r,l,f;return o(this,(function(o){switch(o.label){case 0:o.label=1;case 1:return o.trys.push([1,4,,6]),[4,u.default.create(t,n,s)];case 2:return r=o.sent(),console.log("Fee Account Supply Created"),[4,a.default.create(t,n,s,i)];case 3:return l=o.sent(),console.log("State Account Supply Created"),[2,new e(t,s,r,l)];case 4:return f=o.sent(),console.error("Failed to initialize server",f),[4,c.sleep(1e3)];case 5:return o.sent(),console.log("Retrying initialization"),[3,6];case 6:return[3,0];case 7:return[2]}}))}))},e}();t.default=f},665:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return o(t,e),t},i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{u(r.next(e))}catch(e){s(e)}}function c(e){try{u(r.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}u((r=r.apply(e,t||[])).next())}))},c=this&&this.__generator||function(e,t){var n,r,o,s,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function c(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}};t.__esModule=!0;var u=n(681),a=s(n(288)),l=function(){function e(e,t){this.supply=e,this.accountCost=t}return e.create=function(t,n,r,o){return i(this,void 0,void 0,(function(){var s,l,f,h,p=this;return c(this,(function(d){switch(d.label){case 0:return s=Math.ceil(a.TX_PER_ACCOUNT/8),[4,a.default.calculateRent(t,s)];case 1:return l=d.sent(),f=new a.default("Program Data Account Supply",n.feeAccount,(function(e){return i(p,void 0,void 0,(function(){var n;return c(this,(function(r){switch(r.label){case 0:return n=new u.Account,[4,u.sendAndConfirmTransaction(t,(new u.Transaction).add(u.SystemProgram.createAccount({fromPubkey:e.publicKey,newAccountPubkey:n.publicKey,lamports:l,space:s,programId:o})),[e,n],{commitment:"singleGossip",preflightCommitment:"singleGossip"})];case 1:return r.sent(),[2,n]}}))}))})),h=r.lamportsPerSignature,[2,new e(f,l+2*h)]}}))}))},e}();t.default=l},185:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{u(r.next(e))}catch(e){s(e)}}function c(e){try{u(r.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}u((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,s,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function c(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};t.__esModule=!0;var i=s(n(200)),c=n(593),u=s(n(59)),a=s(n(536)),l="true"===process.env.SEND_TO_RPC,f=function(){function e(e){var t=this;this.connection=e,this.connecting=!1,this.lastSlot=0,this.tpuAddresses=[],this.sockets=new Map,this.connected=function(){return t.activeProxies()>0||l},this.activeProxies=function(){return t.sockets.size},this.connect=function(){return r(t,void 0,void 0,(function(){var e,t;return o(this,(function(n){switch(n.label){case 0:if(l)return console.log("TPU Proxy disabled"),[2];if(this.connecting)return[2];this.connecting=!0,n.label=1;case 1:return n.trys.push([1,3,,5]),console.log("TPU Proxy refreshing..."),[4,this.reconnect()];case 2:return n.sent(),[3,5];case 3:return e=n.sent(),console.error("TPU Proxy failed to connect, reconnecting",e),[4,c.sleep(1e3)];case 4:return n.sent(),[3,5];case 5:if(!this.connected())return[3,1];n.label=6;case 6:return t=this.activeProxies(),console.log(t,"TPU port(s) connected"),this.connecting=!1,[2]}}))}))},this.onTransaction=function(e){l&&"string"!=typeof e?t.connection.sendRawTransaction(e).catch((function(e){console.error(e,"failed to send raw tx")})):t.connected()?t.sockets.forEach((function(n,r){try{n.send(e,(function(e){return t.onTpuResult(r,e)}))}catch(e){t.onTpuResult(r,e)}})):t.connect()},this.reconnect=function(){return r(t,void 0,void 0,(function(){var e,t,n,r,s,c,u=this;return o(this,(function(a){switch(a.label){case 0:e=new Map,t=function(t){var n,r,s,c,a;return o(this,(function(o){switch(o.label){case 0:return n=t.split(":"),r=n[0],s=n[1],c=Number.parseInt(s),a=i.default.createSocket("udp4"),[4,new Promise((function(e){a.on("error",(function(e){return u.onTpuResult(t,e)})),a.connect(c,r,(function(){return e(void 0)}))}))];case 1:return o.sent(),e.set(t,a),[2]}}))},n=0,r=this.tpuAddresses,a.label=1;case 1:return n<r.length?(s=r[n],[5,t(s)]):[3,4];case 2:a.sent(),a.label=3;case 3:return n++,[3,1];case 4:if(0===e.size)throw new Error("No sockets found");return c=this.sockets,this.sockets=e,c.forEach((function(e){e.close()})),[2]}}))}))},this.onTpuResult=function(e,n){n&&(console.error("Error proxying transaction",n),t.sockets.delete(e))}}return e.create=function(t){return r(this,void 0,void 0,(function(){var n,r,s;return o(this,(function(o){switch(o.label){case 0:return n=new e(t),l?[3,3]:[4,a.default.start(t)];case 1:return r=o.sent(),[4,u.default.start(t)];case 2:s=o.sent(),t.onSlotUpdate((function(e){var t=e.type,o=e.slot;if("firstShredReceived"===t&&o>n.lastSlot+10){n.lastSlot=o;var i=r.getUpcomingNodes(o),c=[];i.forEach((function(e){var t=s.nodes.get(e);t?c.push(t):console.error("NO TPU FOUND",e)})),n.tpuAddresses=c,n.connect()}})),o.label=3;case 3:return[2,n]}}))}))},e}();t.default=f},880:(e,t,n)=>{t.__esModule=!0,t.urlTls=t.url=t.cluster=void 0;var r=n(681);t.cluster=function(){if(process.env.LIVE){switch(process.env.CLUSTER){case"devnet":case"testnet":case"mainnet-beta":return process.env.CLUSTER}return"devnet"}}(),t.url=process.env.RPC_URL||(process.env.LIVE?r.clusterApiUrl(t.cluster,!1):"http://localhost:8899"),t.urlTls=process.env.RPC_URL||(process.env.LIVE?r.clusterApiUrl(t.cluster,!0):"http://localhost:8899")},593:function(e,t){var n=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{u(r.next(e))}catch(e){s(e)}}function c(e){try{u(r.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}u((r=r.apply(e,t||[])).next())}))},r=this&&this.__generator||function(e,t){var n,r,o,s,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function c(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}};function o(e){return new Promise((function(t){return setTimeout(t,e)}))}t.__esModule=!0,t.endlessRetry=t.notUndefined=t.sleep=void 0,t.sleep=o,t.notUndefined=function(e){return void 0!==e},t.endlessRetry=function(e,t){return n(this,void 0,void 0,(function(){var n;return r(this,(function(r){switch(r.label){case 0:r.label=1;case 1:return r.trys.push([1,3,,5]),console.log(e,"fetching"),[4,t()];case 2:return[2,r.sent()];case 3:return n=r.sent(),console.error(e,"request failed, retrying",n),[4,o(1e3)];case 4:return r.sent(),[3,5];case 5:return[3,0];case 6:return[2]}}))}))}},69:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};t.__esModule=!0;var o=r(n(439)),s=function(){function e(){}return e.start=function(e,t){var n=0,r=new o.default.Server({server:e});r.on("connection",(function(e){n++,e.on("close",(function(){return n--})),e.on("message",t.onTransaction)})),setInterval((function(){r.clients.forEach((function(e){e.readyState===o.default.OPEN&&e.send(JSON.stringify({activeUsers:n}))}))}),1e3)},e}();t.default=s},681:e=>{e.exports=require("@solana/web3.js")},479:e=>{e.exports=require("cors")},200:e=>{e.exports=require("dgram")},127:e=>{e.exports=require("express")},747:e=>{e.exports=require("fs")},605:e=>{e.exports=require("http")},622:e=>{e.exports=require("path")},742:e=>{e.exports=require("redis")},669:e=>{e.exports=require("util")},439:e=>{e.exports=require("ws")}},t={};!function n(r){if(t[r])return t[r].exports;var o=t[r]={exports:{}};return e[r].call(o.exports,o,o.exports,n),o.exports}(607)})();