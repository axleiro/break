{"ast":null,"code":"var _jsxFileName = \"/Users/jstarry/Workspace/solana/break/client/src/components/PaymentCard.tsx\";\nimport React from \"react\";\nimport QRCode from \"qrcode.react\";\nimport { LAMPORTS_PER_SOL } from \"@solana/web3.js\";\nimport { useConfig, useRefreshAccounts } from \"providers/api\";\nimport { useBalance } from \"providers/balance\";\nimport { useAccountState } from \"providers/account\";\nexport function lamportsToSolString(lamports, maximumFractionDigits = 9) {\n  const sol = Math.abs(lamports) / LAMPORTS_PER_SOL;\n  return \"â—Ž\" + new Intl.NumberFormat(\"en-US\", {\n    maximumFractionDigits\n  }).format(sol);\n}\nexport function getTrustWalletLink(address, amountSol) {\n  const iOS = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;\n  const android = /Android/i.test(navigator.userAgent);\n  if (!iOS && !android) return;\n  let trustWalletDeepLink = `https://link.trustwallet.com/send?coin=501&address=${address}`; // Only the iOS TW handles amount correctly at the moment\n\n  if (iOS) {\n    trustWalletDeepLink += \"&amount=\" + amountSol;\n  }\n\n  return trustWalletDeepLink;\n}\nexport function PaymentCard({\n  account\n}) {\n  var _useConfig;\n\n  const balance = useBalance();\n  const [, setAccount] = useAccountState();\n  const gameCostLamports = ((_useConfig = useConfig()) === null || _useConfig === void 0 ? void 0 : _useConfig.gameCost) || 0;\n  const gameCostSol = gameCostLamports / LAMPORTS_PER_SOL;\n  const address = account.publicKey.toBase58();\n  const balanceSufficient = balance !== \"loading\" && balance >= gameCostLamports;\n  const trustWalletDeepLink = getTrustWalletLink(address, gameCostSol);\n  const [copied, setCopied] = React.useState(false);\n  const [showQR, setShowQR] = React.useState(!trustWalletDeepLink);\n\n  const copyAddress = () => {\n    navigator.clipboard.writeText(address);\n    setCopied(true);\n  };\n\n  React.useEffect(() => {\n    if (!copied) return;\n    const timeoutId = setTimeout(() => {\n      setCopied(false);\n    }, 1000);\n    return () => clearTimeout(timeoutId);\n  }, [copied]);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"card mb-0\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"card-header\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    className: \"card-header-title font-weight-bold\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 9\n    }\n  }, \"Wallet\"), balance !== \"loading\" && /*#__PURE__*/React.createElement(\"span\", {\n    className: `text-${balanceSufficient ? \"primary\" : \"warning\"}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 11\n    }\n  }, balanceSufficient ? \"Press Play to Start\" : trustWalletDeepLink ? \"Add Funds to Play\" : \"Transfer SOL to Play\")), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"card-body\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"d-flex align-items-center justify-content-between mb-4\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"font-weight-bold\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 11\n    }\n  }, \"Address\"), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: \"btn btn-sm btn-white\",\n    onClick: copyAddress,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: \"fe fe-clipboard mr-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 15\n    }\n  }), copied ? \"Copied\" : \"Copy\"))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"d-flex mb-4 pb-4 border-bottom\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: \"badge badge-dark overflow-hidden\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"h4\", {\n    className: \"mb-0 text-truncate\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 13\n    }\n  }, address))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"d-flex align-items-center justify-content-between mb-4 pb-4 border-bottom\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"font-weight-bold\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 11\n    }\n  }, \"QR Code\"), /*#__PURE__*/React.createElement(\"span\", {\n    className: \"btn btn-sm btn-white ml-2\",\n    onClick: () => setShowQR(qr => !qr),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 11\n    }\n  }, showQR ? \"Hide\" : \"Show\")), showQR && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"d-flex justify-content-center align-items-center mb-4 pb-4 border-bottom\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(QRCode, {\n    value: `solana:${address}?amount=${gameCostSol}`,\n    includeMargin: true,\n    bgColor: \"#000\",\n    fgColor: \"#FFF\",\n    renderAs: \"svg\",\n    className: \"qr-code\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"d-flex align-items-center justify-content-between mb-4 pb-4 border-bottom\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"font-weight-bold\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 11\n    }\n  }, \"Live Balance\"), /*#__PURE__*/React.createElement(\"span\", {\n    className: \"badge badge-dark\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"h4\", {\n    className: \"mb-0\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 13\n    }\n  }, balance === \"loading\" ? /*#__PURE__*/React.createElement(\"span\", {\n    className: \"spinner-grow spinner-grow-sm mr-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 17\n    }\n  }) : lamportsToSolString(balance)))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"d-flex align-items-center justify-content-between\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"font-weight-bold\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 11\n    }\n  }, \"Change Wallet\"), /*#__PURE__*/React.createElement(\"span\", {\n    className: \"btn btn-sm btn-white\",\n    onClick: () => setAccount(undefined),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: \"fe fe-list mr-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 13\n    }\n  }), \"List\")), trustWalletDeepLink && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"d-flex align-items-center justify-content-between mt-4 pt-4 border-top\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"font-weight-bold\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 13\n    }\n  }, \"Add Funds\"), /*#__PURE__*/React.createElement(\"a\", {\n    className: \"btn btn-sm btn-info\",\n    href: trustWalletDeepLink,\n    target: \"_blank\",\n    rel: \"noopener noreferrer\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: \"fe fe-external-link mr-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150,\n      columnNumber: 15\n    }\n  }), \"Open Trust Wallet\"))), /*#__PURE__*/React.createElement(Footer, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156,\n      columnNumber: 7\n    }\n  }));\n}\n\nfunction Footer() {\n  var _useConfig2;\n\n  const balance = useBalance();\n  const gameCostLamports = ((_useConfig2 = useConfig()) === null || _useConfig2 === void 0 ? void 0 : _useConfig2.gameCost) || 0;\n  const refreshAccounts = useRefreshAccounts();\n  const sufficient = balance >= gameCostLamports;\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"card-footer d-flex flex-column align-items-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 168,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    type: \"button\",\n    value: \"Play\",\n    disabled: !sufficient,\n    className: \"btn btn-pink w-100 text-uppercase\",\n    onClick: refreshAccounts,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"span\", {\n    className: \"text-muted small mt-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 176,\n      columnNumber: 7\n    }\n  }, \"One play costs \", lamportsToSolString(gameCostLamports)));\n}","map":{"version":3,"sources":["/Users/jstarry/Workspace/solana/break/client/src/components/PaymentCard.tsx"],"names":["React","QRCode","LAMPORTS_PER_SOL","useConfig","useRefreshAccounts","useBalance","useAccountState","lamportsToSolString","lamports","maximumFractionDigits","sol","Math","abs","Intl","NumberFormat","format","getTrustWalletLink","address","amountSol","iOS","test","navigator","userAgent","window","MSStream","android","trustWalletDeepLink","PaymentCard","account","balance","setAccount","gameCostLamports","gameCost","gameCostSol","publicKey","toBase58","balanceSufficient","copied","setCopied","useState","showQR","setShowQR","copyAddress","clipboard","writeText","useEffect","timeoutId","setTimeout","clearTimeout","qr","undefined","Footer","refreshAccounts","sufficient"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport QRCode from \"qrcode.react\";\nimport { Account, LAMPORTS_PER_SOL } from \"@solana/web3.js\";\n\nimport { useConfig, useRefreshAccounts } from \"providers/api\";\nimport { useBalance } from \"providers/balance\";\nimport { useAccountState } from \"providers/account\";\n\nexport function lamportsToSolString(\n  lamports: number,\n  maximumFractionDigits: number = 9\n): string {\n  const sol = Math.abs(lamports) / LAMPORTS_PER_SOL;\n  return (\n    \"â—Ž\" + new Intl.NumberFormat(\"en-US\", { maximumFractionDigits }).format(sol)\n  );\n}\n\nexport function getTrustWalletLink(\n  address: string,\n  amountSol: number\n): string | undefined {\n  const iOS = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;\n  const android = /Android/i.test(navigator.userAgent);\n  if (!iOS && !android) return;\n\n  let trustWalletDeepLink = `https://link.trustwallet.com/send?coin=501&address=${address}`;\n\n  // Only the iOS TW handles amount correctly at the moment\n  if (iOS) {\n    trustWalletDeepLink += \"&amount=\" + amountSol;\n  }\n\n  return trustWalletDeepLink;\n}\n\nexport function PaymentCard({ account }: { account: Account }) {\n  const balance = useBalance();\n  const [, setAccount] = useAccountState();\n  const gameCostLamports = useConfig()?.gameCost || 0;\n  const gameCostSol = gameCostLamports / LAMPORTS_PER_SOL;\n  const address = account.publicKey.toBase58();\n  const balanceSufficient =\n    balance !== \"loading\" && balance >= gameCostLamports;\n  const trustWalletDeepLink = getTrustWalletLink(address, gameCostSol);\n  const [copied, setCopied] = React.useState(false);\n  const [showQR, setShowQR] = React.useState(!trustWalletDeepLink);\n\n  const copyAddress = () => {\n    navigator.clipboard.writeText(address);\n    setCopied(true);\n  };\n\n  React.useEffect(() => {\n    if (!copied) return;\n    const timeoutId = setTimeout(() => {\n      setCopied(false);\n    }, 1000);\n    return () => clearTimeout(timeoutId);\n  }, [copied]);\n\n  return (\n    <div className=\"card mb-0\">\n      <div className=\"card-header\">\n        <h3 className=\"card-header-title font-weight-bold\">Wallet</h3>\n        {balance !== \"loading\" && (\n          <span className={`text-${balanceSufficient ? \"primary\" : \"warning\"}`}>\n            {balanceSufficient\n              ? \"Press Play to Start\"\n              : trustWalletDeepLink\n              ? \"Add Funds to Play\"\n              : \"Transfer SOL to Play\"}\n          </span>\n        )}\n      </div>\n\n      <div className=\"card-body\">\n        <div className=\"d-flex align-items-center justify-content-between mb-4\">\n          <div className=\"font-weight-bold\">Address</div>\n          <div>\n            <span className=\"btn btn-sm btn-white\" onClick={copyAddress}>\n              <span className=\"fe fe-clipboard mr-2\"></span>\n              {copied ? \"Copied\" : \"Copy\"}\n            </span>\n          </div>\n        </div>\n\n        <div className=\"d-flex mb-4 pb-4 border-bottom\">\n          <span className=\"badge badge-dark overflow-hidden\">\n            <h4 className=\"mb-0 text-truncate\">{address}</h4>\n          </span>\n        </div>\n\n        <div className=\"d-flex align-items-center justify-content-between mb-4 pb-4 border-bottom\">\n          <div className=\"font-weight-bold\">QR Code</div>\n          <span\n            className=\"btn btn-sm btn-white ml-2\"\n            onClick={() => setShowQR((qr) => !qr)}\n          >\n            {showQR ? \"Hide\" : \"Show\"}\n          </span>\n        </div>\n\n        {showQR && (\n          <div className=\"d-flex justify-content-center align-items-center mb-4 pb-4 border-bottom\">\n            <QRCode\n              value={`solana:${address}?amount=${gameCostSol}`}\n              includeMargin\n              bgColor=\"#000\"\n              fgColor=\"#FFF\"\n              renderAs=\"svg\"\n              className=\"qr-code\"\n            />\n          </div>\n        )}\n\n        <div className=\"d-flex align-items-center justify-content-between mb-4 pb-4 border-bottom\">\n          <div className=\"font-weight-bold\">Live Balance</div>\n          <span className=\"badge badge-dark\">\n            <h4 className=\"mb-0\">\n              {balance === \"loading\" ? (\n                <span className=\"spinner-grow spinner-grow-sm mr-2\"></span>\n              ) : (\n                lamportsToSolString(balance)\n              )}\n            </h4>\n          </span>\n        </div>\n\n        <div className=\"d-flex align-items-center justify-content-between\">\n          <div className=\"font-weight-bold\">Change Wallet</div>\n          <span\n            className=\"btn btn-sm btn-white\"\n            onClick={() => setAccount(undefined)}\n          >\n            <span className=\"fe fe-list mr-2\"></span>\n            List\n          </span>\n        </div>\n\n        {trustWalletDeepLink && (\n          <div className=\"d-flex align-items-center justify-content-between mt-4 pt-4 border-top\">\n            <div className=\"font-weight-bold\">Add Funds</div>\n            <a\n              className=\"btn btn-sm btn-info\"\n              href={trustWalletDeepLink}\n              target=\"_blank\"\n              rel=\"noopener noreferrer\"\n            >\n              <span className=\"fe fe-external-link mr-2\"></span>\n              Open Trust Wallet\n            </a>\n          </div>\n        )}\n      </div>\n      <Footer />\n    </div>\n  );\n}\n\nfunction Footer() {\n  const balance = useBalance();\n  const gameCostLamports = useConfig()?.gameCost || 0;\n  const refreshAccounts = useRefreshAccounts();\n\n  const sufficient = balance >= gameCostLamports;\n  return (\n    <div className=\"card-footer d-flex flex-column align-items-center\">\n      <input\n        type=\"button\"\n        value=\"Play\"\n        disabled={!sufficient}\n        className=\"btn btn-pink w-100 text-uppercase\"\n        onClick={refreshAccounts}\n      />\n      <span className=\"text-muted small mt-2\">\n        One play costs {lamportsToSolString(gameCostLamports)}\n      </span>\n    </div>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}