{"ast":null,"code":"var _jsxFileName = \"/Users/jstarry/Workspace/solana/break/client/src/providers/api/index.tsx\";\nimport React from \"react\";\nimport { useServer } from \"providers/server\";\nimport { useBalance } from \"providers/balance\";\nimport { fetchWithRetry } from \"./request\";\nimport { Connection } from \"@solana/web3.js\";\nimport { useAccountState } from \"providers/account\";\nexport let ActionType;\n\n(function (ActionType) {\n  ActionType[ActionType[\"Initialize\"] = 0] = \"Initialize\";\n  ActionType[ActionType[\"FetchInit\"] = 1] = \"FetchInit\";\n  ActionType[ActionType[\"ClearAccounts\"] = 2] = \"ClearAccounts\";\n  ActionType[ActionType[\"Ready\"] = 3] = \"Ready\";\n  ActionType[ActionType[\"Override\"] = 4] = \"Override\";\n  ActionType[ActionType[\"Failure\"] = 5] = \"Failure\";\n})(ActionType || (ActionType = {}));\n\nfunction configReducer(state, action) {\n  if (action.type === ActionType.FetchInit) {\n    return {\n      url: action.url\n    };\n  } else if (action.url !== state.url) {\n    return state;\n  }\n\n  switch (action.type) {\n    case ActionType.Ready:\n    case ActionType.Initialize:\n      {\n        return { ...state,\n          ...action,\n          rpc: {\n            url: action.config.rpcUrl,\n            connection: new Connection(action.config.rpcUrl)\n          }\n        };\n      }\n\n    case ActionType.Override:\n      {\n        return { ...state,\n          ...action\n        };\n      }\n\n    case ActionType.ClearAccounts:\n      {\n        return { ...state,\n          accounts: undefined\n        };\n      }\n  }\n}\n\nconst StateContext = React.createContext(undefined);\nconst RefContext = React.createContext(undefined);\nconst DispatchContext = React.createContext(undefined);\nexport function ApiProvider({\n  children\n}) {\n  const [state, dispatch] = React.useReducer(configReducer, {});\n  const {\n    httpUrl\n  } = useServer();\n  const httpUrlRef = React.useRef(httpUrl);\n  React.useEffect(() => {\n    httpUrlRef.current = httpUrl;\n    initConfig(dispatch, httpUrlRef);\n  }, [httpUrl]);\n  const config = state.config;\n  const paymentRequired = config === null || config === void 0 ? void 0 : config.paymentRequired;\n  React.useEffect(() => {\n    httpUrlRef.current = httpUrl;\n    if (paymentRequired !== false) return;\n    refreshAccounts(dispatch, httpUrlRef, undefined);\n  }, [httpUrl, paymentRequired]);\n  return /*#__PURE__*/React.createElement(StateContext.Provider, {\n    value: state,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(DispatchContext.Provider, {\n    value: dispatch,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(RefContext.Provider, {\n    value: httpUrlRef,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 9\n    }\n  }, children)));\n}\n\nasync function initConfig(dispatch, httpUrlRef) {\n  return fetchWithRetry(dispatch, httpUrlRef, {\n    route: \"init\"\n  });\n}\n\nasync function refreshAccounts(dispatch, httpUrlRef, paymentAccount) {\n  return fetchWithRetry(dispatch, httpUrlRef, {\n    route: \"accounts\",\n    paymentAccount\n  });\n}\n\nexport function useAccounts() {\n  const context = React.useContext(StateContext);\n\n  if (!context) {\n    throw new Error(`useAccounts must be used within a ApiProvider`);\n  }\n\n  return context.accounts;\n}\nexport function useConfig() {\n  const context = React.useContext(StateContext);\n\n  if (!context) {\n    throw new Error(`useConfig must be used within a ApiProvider`);\n  }\n\n  return context.config;\n}\nexport function useConnection() {\n  const config = useConfig();\n  return config === null || config === void 0 ? void 0 : config.connection;\n}\nexport function useIsReady() {\n  const context = React.useContext(StateContext);\n\n  if (!context) {\n    throw new Error(`useIsReady must be used within a ApiProvider`);\n  }\n\n  return context.config !== undefined && context.accounts !== undefined;\n}\nexport function useClusterParam() {\n  var _context$config;\n\n  const context = React.useContext(StateContext);\n\n  if (!context) {\n    throw new Error(`useClusterParam must be used within a ApiProvider`);\n  }\n\n  const cluster = context === null || context === void 0 ? void 0 : (_context$config = context.config) === null || _context$config === void 0 ? void 0 : _context$config.cluster;\n\n  if (cluster && cluster !== \"mainnet-beta\") {\n    return `cluster=${cluster}`;\n  } else {\n    return \"\";\n  }\n}\nexport function useClearAccounts() {\n  const dispatch = React.useContext(DispatchContext);\n\n  if (!dispatch) {\n    throw new Error(`useClearAccounts must be used within a ApiProvider`);\n  }\n\n  const httpUrlRef = React.useContext(RefContext);\n\n  if (!httpUrlRef) {\n    throw new Error(`useRefreshAccounts must be used within a ApiProvider`);\n  }\n\n  return React.useCallback(() => {\n    dispatch({\n      type: ActionType.ClearAccounts,\n      url: httpUrlRef.current\n    });\n  }, [dispatch, httpUrlRef]);\n}\nexport function useRefreshAccounts() {\n  const dispatch = React.useContext(DispatchContext);\n\n  if (!dispatch) {\n    throw new Error(`useRefreshAccounts must be used within a ApiProvider`);\n  }\n\n  const httpUrlRef = React.useContext(RefContext);\n\n  if (!httpUrlRef) {\n    throw new Error(`useRefreshAccounts must be used within a ApiProvider`);\n  }\n\n  const config = useConfig();\n  const [paymentAccount] = useAccountState();\n  const paymentRequired = config === null || config === void 0 ? void 0 : config.paymentRequired;\n  const balance = useBalance();\n  const cost = config === null || config === void 0 ? void 0 : config.gameCost;\n  return React.useCallback(() => {\n    if (paymentRequired === undefined || cost === undefined) return;\n\n    if (paymentRequired) {\n      if (!paymentAccount || balance === \"loading\" || balance < cost) {\n        dispatch({\n          type: ActionType.ClearAccounts,\n          url: httpUrlRef.current\n        });\n        return;\n      }\n\n      refreshAccounts(dispatch, httpUrlRef, paymentAccount);\n    } else {\n      refreshAccounts(dispatch, httpUrlRef, undefined);\n    }\n  }, [httpUrlRef, dispatch, paymentAccount, paymentRequired, balance, cost]);\n}","map":{"version":3,"sources":["/Users/jstarry/Workspace/solana/break/client/src/providers/api/index.tsx"],"names":["React","useServer","useBalance","fetchWithRetry","Connection","useAccountState","ActionType","configReducer","state","action","type","FetchInit","url","Ready","Initialize","rpc","config","rpcUrl","connection","Override","ClearAccounts","accounts","undefined","StateContext","createContext","RefContext","DispatchContext","ApiProvider","children","dispatch","useReducer","httpUrl","httpUrlRef","useRef","useEffect","current","initConfig","paymentRequired","refreshAccounts","route","paymentAccount","useAccounts","context","useContext","Error","useConfig","useConnection","useIsReady","useClusterParam","cluster","useClearAccounts","useCallback","useRefreshAccounts","balance","cost","gameCost"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport { Config, AccountsConfig } from \"./config\";\nimport { useServer } from \"providers/server\";\nimport { useBalance } from \"providers/balance\";\nimport { fetchWithRetry } from \"./request\";\nimport { Account, Connection } from \"@solana/web3.js\";\nimport { useAccountState } from \"providers/account\";\n\nexport enum ActionType {\n  Initialize,\n  FetchInit,\n  ClearAccounts,\n  Ready,\n  Override,\n  Failure,\n}\n\ninterface Rpc {\n  url: string;\n  connection: Connection;\n}\n\ninterface State {\n  rpc?: Rpc;\n  url?: string;\n  config?: Config;\n  accounts?: AccountsConfig;\n}\n\ninterface Initialize {\n  type: ActionType.Initialize;\n  url: string;\n  config: Config;\n}\n\ninterface FetchInit {\n  type: ActionType.FetchInit;\n  url: string;\n}\n\ninterface ClearAccounts {\n  type: ActionType.ClearAccounts;\n  url: string;\n}\n\ninterface OverrideRpc {\n  type: ActionType.Override;\n  url: string;\n  rpc: Rpc;\n}\n\ninterface Ready {\n  type: ActionType.Ready;\n  url: string;\n  accounts: AccountsConfig;\n}\n\nexport type Action = Initialize | FetchInit | ClearAccounts | Override | Ready;\nexport type Dispatch = (action: Action) => void;\n\nfunction configReducer(state: State, action: Action): State {\n  if (action.type === ActionType.FetchInit) {\n    return { url: action.url };\n  } else if (action.url !== state.url) {\n    return state;\n  }\n\n  switch (action.type) {\n    case ActionType.Ready:\n    case ActionType.Initialize: {\n      return { ...state, ...action, rpc: {\n        url: action.config.rpcUrl,\n        connection: new Connection(action.config.rpcUrl),\n      }};\n    }\n    case ActionType.Override: {\n      return { ...state, ...action };\n    }\n    case ActionType.ClearAccounts: {\n      return {\n        ...state,\n        accounts: undefined,\n      };\n    }\n  }\n}\n\nconst StateContext = React.createContext<State | undefined>(undefined);\nconst RefContext = React.createContext<\n  React.MutableRefObject<string> | undefined\n>(undefined);\nconst DispatchContext = React.createContext<Dispatch | undefined>(undefined);\n\ntype ApiProviderProps = { children: React.ReactNode };\nexport function ApiProvider({ children }: ApiProviderProps) {\n  const [state, dispatch] = React.useReducer(configReducer, {});\n\n  const { httpUrl } = useServer();\n  const httpUrlRef = React.useRef(httpUrl);\n  React.useEffect(() => {\n    httpUrlRef.current = httpUrl;\n    initConfig(dispatch, httpUrlRef);\n  }, [httpUrl]);\n\n  const config = state.config;\n  const paymentRequired = config?.paymentRequired;\n  React.useEffect(() => {\n    httpUrlRef.current = httpUrl;\n    if (paymentRequired !== false) return;\n    refreshAccounts(dispatch, httpUrlRef, undefined);\n  }, [httpUrl, paymentRequired]);\n\n  return (\n    <StateContext.Provider value={state}>\n      <DispatchContext.Provider value={dispatch}>\n        <RefContext.Provider value={httpUrlRef}>{children}</RefContext.Provider>\n      </DispatchContext.Provider>\n    </StateContext.Provider>\n  );\n}\n\nasync function initConfig(\n  dispatch: Dispatch,\n  httpUrlRef: React.MutableRefObject<string>\n): Promise<void> {\n  return fetchWithRetry(dispatch, httpUrlRef, { route: \"init\" });\n}\n\nasync function refreshAccounts(\n  dispatch: Dispatch,\n  httpUrlRef: React.MutableRefObject<string>,\n  paymentAccount: Account | undefined\n): Promise<void> {\n  return fetchWithRetry(dispatch, httpUrlRef, {\n    route: \"accounts\",\n    paymentAccount,\n  });\n}\n\nexport function useAccounts() {\n  const context = React.useContext(StateContext);\n  if (!context) {\n    throw new Error(`useAccounts must be used within a ApiProvider`);\n  }\n  return context.accounts;\n}\n\nexport function useConfig() {\n  const context = React.useContext(StateContext);\n  if (!context) {\n    throw new Error(`useConfig must be used within a ApiProvider`);\n  }\n  return context.config;\n}\n\nexport function useConnection() {\n  const config = useConfig();\n  return config?.connection;\n}\n\nexport function useIsReady() {\n  const context = React.useContext(StateContext);\n  if (!context) {\n    throw new Error(`useIsReady must be used within a ApiProvider`);\n  }\n  return context.config !== undefined && context.accounts !== undefined;\n}\n\nexport function useClusterParam(): string {\n  const context = React.useContext(StateContext);\n  if (!context) {\n    throw new Error(`useClusterParam must be used within a ApiProvider`);\n  }\n  const cluster = context?.config?.cluster;\n  if (cluster && cluster !== \"mainnet-beta\") {\n    return `cluster=${cluster}`;\n  } else {\n    return \"\";\n  }\n}\n\nexport function useClearAccounts() {\n  const dispatch = React.useContext(DispatchContext);\n  if (!dispatch) {\n    throw new Error(`useClearAccounts must be used within a ApiProvider`);\n  }\n  const httpUrlRef = React.useContext(RefContext);\n  if (!httpUrlRef) {\n    throw new Error(`useRefreshAccounts must be used within a ApiProvider`);\n  }\n\n  return React.useCallback(() => {\n    dispatch({ type: ActionType.ClearAccounts, url: httpUrlRef.current });\n  }, [dispatch, httpUrlRef]);\n}\n\nexport function useRefreshAccounts() {\n  const dispatch = React.useContext(DispatchContext);\n  if (!dispatch) {\n    throw new Error(`useRefreshAccounts must be used within a ApiProvider`);\n  }\n  const httpUrlRef = React.useContext(RefContext);\n  if (!httpUrlRef) {\n    throw new Error(`useRefreshAccounts must be used within a ApiProvider`);\n  }\n  const config = useConfig();\n  const [paymentAccount] = useAccountState();\n  const paymentRequired = config?.paymentRequired;\n  const balance = useBalance();\n  const cost = config?.gameCost;\n  return React.useCallback(() => {\n    if (paymentRequired === undefined || cost === undefined) return;\n    if (paymentRequired) {\n      if (!paymentAccount || balance === \"loading\" || balance < cost) {\n        dispatch({ type: ActionType.ClearAccounts, url: httpUrlRef.current });\n        return;\n      }\n      refreshAccounts(dispatch, httpUrlRef, paymentAccount);\n    } else {\n      refreshAccounts(dispatch, httpUrlRef, undefined);\n    }\n  }, [httpUrlRef, dispatch, paymentAccount, paymentRequired, balance, cost]);\n}\n"]},"metadata":{},"sourceType":"module"}