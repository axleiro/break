{"ast":null,"code":"module.exports = function (e) {\n  var t = {};\n\n  function r(n) {\n    if (t[n]) return t[n].exports;\n    var a = t[n] = {\n      i: n,\n      l: !1,\n      exports: {}\n    };\n    return e[n].call(a.exports, a, a.exports, r), a.l = !0, a.exports;\n  }\n\n  return r.m = e, r.c = t, r.d = function (e, t, n) {\n    r.o(e, t) || Object.defineProperty(e, t, {\n      enumerable: !0,\n      get: n\n    });\n  }, r.r = function (e) {\n    \"undefined\" != typeof Symbol && Symbol.toStringTag && Object.defineProperty(e, Symbol.toStringTag, {\n      value: \"Module\"\n    }), Object.defineProperty(e, \"__esModule\", {\n      value: !0\n    });\n  }, r.t = function (e, t) {\n    if (1 & t && (e = r(e)), 8 & t) return e;\n    if (4 & t && \"object\" == typeof e && e && e.__esModule) return e;\n    var n = Object.create(null);\n    if (r.r(n), Object.defineProperty(n, \"default\", {\n      enumerable: !0,\n      value: e\n    }), 2 & t && \"string\" != typeof e) for (var a in e) {\n      r.d(n, a, function (t) {\n        return e[t];\n      }.bind(null, a));\n    }\n    return n;\n  }, r.n = function (e) {\n    var t = e && e.__esModule ? function () {\n      return e.default;\n    } : function () {\n      return e;\n    };\n    return r.d(t, \"a\", t), t;\n  }, r.o = function (e, t) {\n    return Object.prototype.hasOwnProperty.call(e, t);\n  }, r.p = \"\", r(r.s = 15);\n}([function (e, t) {\n  e.exports = require(\"bn.js\");\n}, function (e, t) {\n  e.exports = require(\"@babel/runtime/regenerator\");\n}, function (e, t) {\n  e.exports = require(\"@toruslabs/http-helpers\");\n}, function (e, t) {\n  e.exports = require(\"web3-utils\");\n}, function (e, t) {\n  e.exports = require(\"json-stable-stringify\");\n}, function (e, t) {\n  e.exports = require(\"@babel/runtime/helpers/asyncToGenerator\");\n}, function (e, t) {\n  e.exports = require(\"@toruslabs/eccrypto\");\n}, function (e, t) {\n  e.exports = require(\"@babel/runtime/helpers/defineProperty\");\n}, function (e, t) {\n  e.exports = require(\"@babel/runtime/helpers/toConsumableArray\");\n}, function (e, t) {\n  e.exports = require(\"@babel/runtime/helpers/typeof\");\n}, function (e, t) {\n  e.exports = require(\"@babel/runtime/helpers/classCallCheck\");\n}, function (e, t) {\n  e.exports = require(\"@babel/runtime/helpers/createClass\");\n}, function (e, t) {\n  e.exports = require(\"elliptic\");\n}, function (e, t) {\n  e.exports = require(\"memory-cache\");\n}, function (e, t) {\n  e.exports = require(\"loglevel\");\n}, function (e, t, r) {\n  \"use strict\";\n\n  r.r(t);\n\n  var n = r(1),\n      a = r.n(n),\n      o = r(7),\n      i = r.n(o),\n      u = r(9),\n      c = r.n(u),\n      s = r(5),\n      f = r.n(s),\n      l = r(10),\n      p = r.n(l),\n      h = r(11),\n      b = r.n(h),\n      d = r(6),\n      g = r(2),\n      m = r(0),\n      v = r.n(m),\n      y = r(12),\n      k = r(4),\n      x = r.n(k),\n      O = r(13),\n      w = r.n(O),\n      P = r(3),\n      j = r(14),\n      S = r.n(j).a.getLogger(\"torus.js\"),\n      _ = function _(e, t) {\n    return new Promise(function (r, n) {\n      var a,\n          o = 0,\n          i = {\n        resolved: !1\n      },\n          u = new Array(e.length).fill(void 0),\n          c = new Array(e.length).fill(void 0);\n      e.forEach(function (s, f) {\n        s.then(function (e) {\n          c[f] = e;\n        }).catch(function (e) {\n          u[f] = e;\n        }).finally(function () {\n          i.resolved || t(c.slice(0), i).then(function (e) {\n            i.resolved = !0, r(e);\n          }).catch(function (e) {\n            a = e;\n          }).finally(function (t) {\n            var r;\n            (o += 1) === e.length && n(new Error(\"Unable to resolve enough promises, errors: \".concat(JSON.stringify(u), \", responses: \").concat(JSON.stringify(c), \", predicate: \").concat((null === (r = a) || void 0 === r ? void 0 : r.message) || a)));\n          });\n        });\n      });\n    });\n  },\n      q = r(8),\n      A = r.n(q);\n\n  function C(e, t) {\n    var r = Object.keys(e);\n\n    if (Object.getOwnPropertySymbols) {\n      var n = Object.getOwnPropertySymbols(e);\n      t && (n = n.filter(function (t) {\n        return Object.getOwnPropertyDescriptor(e, t).enumerable;\n      })), r.push.apply(r, n);\n    }\n\n    return r;\n  }\n\n  function K(e) {\n    for (var t = 1; t < arguments.length; t++) {\n      var r = null != arguments[t] ? arguments[t] : {};\n      t % 2 ? C(Object(r), !0).forEach(function (t) {\n        i()(e, t, r[t]);\n      }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(r)) : C(Object(r)).forEach(function (t) {\n        Object.defineProperty(e, t, Object.getOwnPropertyDescriptor(r, t));\n      });\n    }\n\n    return e;\n  }\n\n  var M = function e(t, r) {\n    var n = t;\n    if (\"number\" == typeof n && (n = Array.from({\n      length: n\n    }, function (e, t) {\n      return t;\n    })), r > n.length || r <= 0) return [];\n    if (r === n.length) return [n];\n    if (1 === r) return n.reduce(function (e, t) {\n      return [].concat(A()(e), [[t]]);\n    }, []);\n\n    for (var a = [], o = [], i = 0; i <= n.length - r + 1; i += 1) {\n      o = e(n.slice(i + 1), r - 1);\n\n      for (var u = 0; u < o.length; u += 1) {\n        a.push([n[i]].concat(A()(o[u])));\n      }\n    }\n\n    return a;\n  },\n      E = function E(e, t) {\n    for (var r = {}, n = 0; n < e.length; n += 1) {\n      var a = x()(e[n]);\n      if (r[a] = r[a] ? r[a] + 1 : 1, r[a] === t) return e[n];\n    }\n  },\n      X = function X(e, t, r) {\n    var n = e.map(function (e) {\n      return Object(g.post)(e, Object(g.generateJsonRPCObject)(\"VerifierLookupRequest\", {\n        verifier: t,\n        verifier_id: r.toString()\n      })).catch(function (e) {\n        return S.error(\"lookup request failed\", e);\n      });\n    });\n    return _(n, function (t) {\n      var r = t.filter(function (e) {\n        return e;\n      }),\n          n = E(r.map(function (e) {\n        return e && e.error;\n      }), 1 + ~~(e.length / 2)),\n          a = E(r.map(function (e) {\n        return e && e.result;\n      }), 1 + ~~(e.length / 2));\n      return a || n ? Promise.resolve({\n        keyResult: a,\n        errorResult: n\n      }) : Promise.reject(new Error(\"invalid results \".concat(JSON.stringify(t))));\n    }).catch(function (e) {\n      return S.error(\"Some for keylookup failed\", e);\n    });\n  },\n      Y = function Y(e, t, r, n) {\n    return new Promise(function (a, o) {\n      setTimeout(function () {\n        X(e, t, r).then(a).catch(o);\n      }, n);\n    });\n  },\n      J = function e(t, r, n, a, o, i) {\n    var u, c;\n    if (void 0 === n ? (u = Math.floor(Math.random() * t.length), c = u) : u = n % t.length, u === a) throw new Error(\"Looped through all\");\n    void 0 !== a && (c = a);\n    var s = Object(g.generateJsonRPCObject)(\"KeyAssign\", {\n      verifier: o,\n      verifier_id: i.toString()\n    });\n    return Object(g.post)(\"https://signer.tor.us/api/sign\", s, {\n      headers: {\n        pubKeyX: r[u].X,\n        pubKeyY: r[u].Y\n      }\n    }, {\n      useAPIKey: !0\n    }).then(function (n) {\n      return Object(g.post)(t[u], K(K({}, s), n), {\n        headers: {\n          \"Content-Type\": \"application/json; charset=utf-8\"\n        }\n      }).catch(function (n) {\n        return e(t, r, u + 1, c, o, i);\n      });\n    });\n  };\n\n  function I(e, t) {\n    var r = Object.keys(e);\n\n    if (Object.getOwnPropertySymbols) {\n      var n = Object.getOwnPropertySymbols(e);\n      t && (n = n.filter(function (t) {\n        return Object.getOwnPropertyDescriptor(e, t).enumerable;\n      })), r.push.apply(r, n);\n    }\n\n    return r;\n  }\n\n  function R(e) {\n    for (var t = 1; t < arguments.length; t++) {\n      var r = null != arguments[t] ? arguments[t] : {};\n      t % 2 ? I(Object(r), !0).forEach(function (t) {\n        i()(e, t, r[t]);\n      }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(r)) : I(Object(r)).forEach(function (t) {\n        Object.defineProperty(e, t, Object.getOwnPropertyDescriptor(r, t));\n      });\n    }\n\n    return e;\n  }\n\n  var N = function () {\n    function e() {\n      var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {},\n          r = t.enableLogging,\n          n = void 0 !== r && r,\n          a = t.metadataHost,\n          o = void 0 === a ? \"https://metadata.tor.us\" : a,\n          i = t.allowHost,\n          u = void 0 === i ? \"https://signer.tor.us/api/allow\" : i;\n      p()(this, e), this.ec = new y.ec(\"secp256k1\"), this.metadataHost = o, this.allowHost = u, this.metadataCache = w.a, n || S.disableAll(), this.metadataLock = {};\n    }\n\n    var t, r, n, o;\n    return b()(e, [{\n      key: \"retrieveShares\",\n      value: (o = f()(a.a.mark(function e(t, r, n, o, i) {\n        var u,\n            s,\n            l,\n            p,\n            h,\n            b,\n            m,\n            y,\n            k,\n            x = this,\n            O = arguments;\n        return a.a.wrap(function (e) {\n          for (;;) {\n            switch (e.prev = e.next) {\n              case 0:\n                return u = O.length > 5 && void 0 !== O[5] ? O[5] : {}, s = [], e.next = 4, Object(g.get)(this.allowHost, {}, {\n                  useAPIKey: !0\n                });\n\n              case 4:\n                for (l = Object(d.generatePrivate)(), p = Object(d.getPublic)(l).toString(\"hex\"), h = p.slice(2, 66), b = p.slice(66), m = Object(P.keccak256)(i), y = 0; y < t.length; y += 1) {\n                  k = Object(g.post)(t[y], Object(g.generateJsonRPCObject)(\"CommitmentRequest\", {\n                    messageprefix: \"mug00\",\n                    tokencommitment: m.slice(2),\n                    temppubx: h,\n                    temppuby: b,\n                    verifieridentifier: n\n                  })).catch(function (e) {\n                    return S.error(\"commitment\", e);\n                  }), s.push(k);\n                }\n\n                return e.abrupt(\"return\", _(s, function (e) {\n                  return e.filter(function (e) {\n                    return !(!e || \"object\" !== c()(e) || e.error);\n                  }).length >= 3 * ~~(t.length / 4) + 1 ? Promise.resolve(e) : Promise.reject(new Error(\"invalid \".concat(JSON.stringify(e))));\n                }).then(function (e) {\n                  for (var c = [], s = [], p = 0; p < e.length; p += 1) {\n                    e[p] && s.push(e[p].result);\n                  }\n\n                  for (var h = 0; h < t.length; h += 1) {\n                    var b = Object(g.post)(t[h], Object(g.generateJsonRPCObject)(\"ShareRequest\", {\n                      encrypted: \"yes\",\n                      item: [R(R({}, o), {}, {\n                        idtoken: i,\n                        nodesignatures: s,\n                        verifieridentifier: n\n                      }, u)]\n                    })).catch(function (e) {\n                      return S.error(\"share req\", e);\n                    });\n                    c.push(b);\n                  }\n\n                  return _(c, function () {\n                    var e = f()(a.a.mark(function e(n, o) {\n                      var i, u, c, s, f, p, h, b, g, m, y, k, O, w;\n                      return a.a.wrap(function (e) {\n                        for (;;) {\n                          switch (e.prev = e.next) {\n                            case 0:\n                              if (i = n.filter(function (e) {\n                                return e;\n                              }), u = E(n.map(function (e) {\n                                return e && e.result && e.result.keys[0].PublicKey;\n                              }), 1 + ~~(t.length / 2)), !(i.length >= 1 + ~~(t.length / 2) && u)) {\n                                e.next = 32;\n                                break;\n                              }\n\n                              for (c = [], s = [], f = 0; f < n.length; f += 1) {\n                                n[f] && n[f].result && n[f].result.keys && n[f].result.keys.length > 0 ? (n[f].result.keys.sort(function (e, t) {\n                                  return new v.a(e.Index, 16).cmp(new v.a(t.Index, 16));\n                                }), n[f].result.keys[0].Metadata ? (p = {\n                                  ephemPublicKey: Buffer.from(n[f].result.keys[0].Metadata.ephemPublicKey, \"hex\"),\n                                  iv: Buffer.from(n[f].result.keys[0].Metadata.iv, \"hex\"),\n                                  mac: Buffer.from(n[f].result.keys[0].Metadata.mac, \"hex\"),\n                                  mode: Buffer.from(n[f].result.keys[0].Metadata.mode, \"hex\")\n                                }, c.push(Object(d.decrypt)(l, R(R({}, p), {}, {\n                                  ciphertext: Buffer.from(atob(n[f].result.keys[0].Share).padStart(64, \"0\"), \"hex\")\n                                })).catch(function (e) {\n                                  return S.debug(\"share decryption\", e);\n                                }))) : c.push(Promise.resolve(Buffer.from(n[f].result.keys[0].Share.padStart(64, \"0\"), \"hex\")))) : c.push(Promise.resolve(void 0)), s.push(new v.a(r[f], 16));\n                              }\n\n                              return e.next = 8, Promise.all(c);\n\n                            case 8:\n                              if (h = e.sent, !o.resolved) {\n                                e.next = 11;\n                                break;\n                              }\n\n                              return e.abrupt(\"return\", void 0);\n\n                            case 11:\n                              b = h.reduce(function (e, t, r) {\n                                return t && e.push({\n                                  index: s[r],\n                                  value: new v.a(t)\n                                }), e;\n                              }, []), g = M(b.length, 1 + ~~(t.length / 2)), y = function y(e) {\n                                var t = g[e],\n                                    r = b.filter(function (e, r) {\n                                  return t.includes(r);\n                                }),\n                                    n = r.map(function (e) {\n                                  return e.value;\n                                }),\n                                    a = r.map(function (e) {\n                                  return e.index;\n                                }),\n                                    o = x.lagrangeInterpolation(n, a),\n                                    i = Object(d.getPublic)(Buffer.from(o.toString(16, 64), \"hex\")).toString(\"hex\"),\n                                    c = i.slice(2, 66),\n                                    s = i.slice(66);\n                                if (0 === new v.a(c, 16).cmp(new v.a(u.X, 16)) && 0 === new v.a(s, 16).cmp(new v.a(u.Y, 16))) return m = o, \"break\";\n                              }, k = 0;\n\n                            case 15:\n                              if (!(k < g.length)) {\n                                e.next = 22;\n                                break;\n                              }\n\n                              if (\"break\" !== y(k)) {\n                                e.next = 19;\n                                break;\n                              }\n\n                              return e.abrupt(\"break\", 22);\n\n                            case 19:\n                              k += 1, e.next = 15;\n                              break;\n\n                            case 22:\n                              if (void 0 !== m) {\n                                e.next = 24;\n                                break;\n                              }\n\n                              throw new Error(\"could not derive private key\");\n\n                            case 24:\n                              return e.next = 26, x.getMetadata({\n                                pub_key_X: u.X,\n                                pub_key_Y: u.Y\n                              });\n\n                            case 26:\n                              if (O = e.sent, !o.resolved) {\n                                e.next = 29;\n                                break;\n                              }\n\n                              return e.abrupt(\"return\", void 0);\n\n                            case 29:\n                              return m = m.add(O).umod(x.ec.curve.n), w = x.generateAddressFromPrivKey(m), e.abrupt(\"return\", {\n                                ethAddress: w,\n                                privKey: m.toString(\"hex\", 64),\n                                metadataNonce: O\n                              });\n\n                            case 32:\n                              throw new Error(\"invalid\");\n\n                            case 33:\n                            case \"end\":\n                              return e.stop();\n                          }\n                        }\n                      }, e);\n                    }));\n                    return function (t, r) {\n                      return e.apply(this, arguments);\n                    };\n                  }());\n                }));\n\n              case 11:\n              case \"end\":\n                return e.stop();\n            }\n          }\n        }, e, this);\n      })), function (e, t, r, n, a) {\n        return o.apply(this, arguments);\n      })\n    }, {\n      key: \"getMetadata\",\n      value: (n = f()(a.a.mark(function e(t, r) {\n        var n,\n            o,\n            i,\n            u,\n            c = this;\n        return a.a.wrap(function (e) {\n          for (;;) {\n            switch (e.prev = e.next) {\n              case 0:\n                if (e.prev = 0, o = x()(t), null === this.metadataLock[o]) {\n                  e.next = 7;\n                  break;\n                }\n\n                return e.next = 5, this.metadataLock[o];\n\n              case 5:\n                e.next = 8;\n                break;\n\n              case 7:\n                this.metadataLock[o] = new Promise(function (e) {\n                  n = function n() {\n                    c.metadataLock[o] = null, e();\n                  };\n                });\n\n              case 8:\n                if (null === (i = this.metadataCache.get(o))) {\n                  e.next = 12;\n                  break;\n                }\n\n                return n && n(), e.abrupt(\"return\", i);\n\n              case 12:\n                return e.next = 14, Object(g.post)(\"\".concat(this.metadataHost, \"/get\"), t, r, {\n                  useAPIKey: !0\n                });\n\n              case 14:\n                if ((u = e.sent) && u.message) {\n                  e.next = 19;\n                  break;\n                }\n\n                return this.metadataCache.put(o, new v.a(0), 6e4), n && n(), e.abrupt(\"return\", new v.a(0));\n\n              case 19:\n                return this.metadataCache.put(o, new v.a(u.message, 16), 6e4), e.abrupt(\"return\", new v.a(u.message, 16));\n\n              case 23:\n                return e.prev = 23, e.t0 = e.catch(0), S.error(\"get metadata error\", e.t0), n && n(), e.abrupt(\"return\", new v.a(0));\n\n              case 28:\n              case \"end\":\n                return e.stop();\n            }\n          }\n        }, e, this, [[0, 23]]);\n      })), function (e, t) {\n        return n.apply(this, arguments);\n      })\n    }, {\n      key: \"generateMetadataParams\",\n      value: function value(e, t) {\n        var r = this.ec.keyFromPrivate(t.toString(\"hex\", 64)),\n            n = {\n          data: e,\n          timestamp: new v.a(~~(Date.now() / 1e3)).toString(16)\n        },\n            a = r.sign(Object(P.keccak256)(x()(n)).slice(2));\n        return {\n          pub_key_X: r.getPublic().getX().toString(\"hex\"),\n          pub_key_Y: r.getPublic().getY().toString(\"hex\"),\n          set_data: n,\n          signature: Buffer.from(a.r.toString(16, 64) + a.s.toString(16, 64) + new v.a(a.v).toString(16, 2), \"hex\").toString(\"base64\")\n        };\n      }\n    }, {\n      key: \"setMetadata\",\n      value: (r = f()(a.a.mark(function e(t, r) {\n        var n;\n        return a.a.wrap(function (e) {\n          for (;;) {\n            switch (e.prev = e.next) {\n              case 0:\n                return e.prev = 0, this.metadataCache.del(x()({\n                  pub_key_X: t.pub_key_X,\n                  pub_key_Y: t.pub_key_Y\n                })), e.next = 4, Object(g.post)(\"\".concat(this.metadataHost, \"/set\"), t, r, {\n                  useAPIKey: !0\n                });\n\n              case 4:\n                return n = e.sent, e.abrupt(\"return\", n.message);\n\n              case 8:\n                return e.prev = 8, e.t0 = e.catch(0), S.error(\"set metadata error\", e.t0), e.abrupt(\"return\", \"\");\n\n              case 12:\n              case \"end\":\n                return e.stop();\n            }\n          }\n        }, e, this, [[0, 8]]);\n      })), function (e, t) {\n        return r.apply(this, arguments);\n      })\n    }, {\n      key: \"lagrangeInterpolation\",\n      value: function value(e, t) {\n        if (e.length !== t.length) return null;\n\n        for (var r = new v.a(0), n = 0; n < e.length; n += 1) {\n          for (var a = new v.a(1), o = new v.a(1), i = 0; i < e.length; i += 1) {\n            if (n !== i) {\n              a = (a = a.mul(t[i].neg())).umod(this.ec.curve.n);\n              var u = t[n].sub(t[i]);\n              u = u.umod(this.ec.curve.n), o = o.mul(u).umod(this.ec.curve.n);\n            }\n          }\n\n          var c = a.mul(o.invm(this.ec.curve.n)).umod(this.ec.curve.n);\n          c = c.mul(e[n]).umod(this.ec.curve.n), r = r.add(c);\n        }\n\n        return r.umod(this.ec.curve.n);\n      }\n    }, {\n      key: \"generateAddressFromPrivKey\",\n      value: function value(e) {\n        var t = this.ec.keyFromPrivate(e.toString(\"hex\", 64), \"hex\").getPublic().encode(\"hex\").slice(2),\n            r = \"0x\".concat(Object(P.keccak256)(Buffer.from(t, \"hex\")).slice(26));\n        return Object(P.toChecksumAddress)(r);\n      }\n    }, {\n      key: \"generateAddressFromPubKey\",\n      value: function value(e, t) {\n        var r = this.ec.keyFromPublic({\n          x: e.toString(\"hex\", 64),\n          y: t.toString(\"hex\", 64)\n        }).getPublic().encode(\"hex\").slice(2),\n            n = \"0x\".concat(Object(P.keccak256)(Buffer.from(r, \"hex\")).slice(26));\n        return Object(P.toChecksumAddress)(n);\n      }\n    }, {\n      key: \"getPublicAddress\",\n      value: (t = f()(a.a.mark(function e(t, r, n) {\n        var o,\n            i,\n            u,\n            c,\n            s,\n            f,\n            l,\n            p,\n            h,\n            b,\n            d,\n            g,\n            m,\n            v,\n            y = arguments;\n        return a.a.wrap(function (e) {\n          for (;;) {\n            switch (e.prev = e.next) {\n              case 0:\n                return o = n.verifier, i = n.verifierId, u = y.length > 3 && void 0 !== y[3] && y[3], e.next = 4, X(t, o, i);\n\n              case 4:\n                if (e.t0 = e.sent, e.t0) {\n                  e.next = 7;\n                  break;\n                }\n\n                e.t0 = {};\n\n              case 7:\n                if (s = e.t0, f = s.keyResult, !(l = s.errorResult) || !JSON.stringify(l).includes(\"Verifier + VerifierID has not yet been assigned\")) {\n                  e.next = 22;\n                  break;\n                }\n\n                return e.next = 13, J(t, r, void 0, void 0, o, i);\n\n              case 13:\n                return e.next = 15, Y(t, o, i, 1e3);\n\n              case 15:\n                if (e.t1 = e.sent, e.t1) {\n                  e.next = 18;\n                  break;\n                }\n\n                e.t1 = {};\n\n              case 18:\n                p = e.t1, c = p.keyResult, e.next = 27;\n                break;\n\n              case 22:\n                if (!f) {\n                  e.next = 26;\n                  break;\n                }\n\n                c = f, e.next = 27;\n                break;\n\n              case 26:\n                throw new Error(\"node results do not match at first lookup \".concat(JSON.stringify(f || {}), \", \").concat(JSON.stringify(l || {})));\n\n              case 27:\n                if (!c) {\n                  e.next = 39;\n                  break;\n                }\n\n                return h = c.keys[0], b = h.pub_key_X, d = h.pub_key_Y, e.next = 31, this.getMetadata({\n                  pub_key_X: b,\n                  pub_key_Y: d\n                });\n\n              case 31:\n                if (g = e.sent, m = this.ec.keyFromPublic({\n                  x: b.toString(16),\n                  y: d.toString(16)\n                }).getPublic().add(this.ec.keyFromPrivate(g.toString(16)).getPublic()), b = m.getX().toString(16), d = m.getY().toString(16), v = this.generateAddressFromPubKey(m.getX(), m.getY()), u) {\n                  e.next = 38;\n                  break;\n                }\n\n                return e.abrupt(\"return\", v);\n\n              case 38:\n                return e.abrupt(\"return\", {\n                  address: v,\n                  X: b,\n                  Y: d,\n                  metadataNonce: g\n                });\n\n              case 39:\n                throw new Error(\"node results do not match at final lookup \".concat(JSON.stringify(f || {}), \", \").concat(JSON.stringify(l || {})));\n\n              case 40:\n              case \"end\":\n                return e.stop();\n            }\n          }\n        }, e, this);\n      })), function (e, r, n) {\n        return t.apply(this, arguments);\n      })\n    }], [{\n      key: \"setAPIKey\",\n      value: function value(e) {\n        Object(g.setAPIKey)(e);\n      }\n    }, {\n      key: \"setEmbedHost\",\n      value: function value(e) {\n        Object(g.setEmbedHost)(e);\n      }\n    }]), e;\n  }();\n\n  t.default = N;\n}]).default;","map":{"version":3,"sources":["/Users/jstarry/Workspace/solana/break/client/node_modules/@toruslabs/torus.js/dist/torusUtils.cjs.js"],"names":["module","exports","e","t","r","n","a","i","l","call","m","c","d","o","Object","defineProperty","enumerable","get","Symbol","toStringTag","value","__esModule","create","bind","default","prototype","hasOwnProperty","p","s","require","u","f","h","b","g","v","y","k","x","O","w","P","j","S","getLogger","_","Promise","resolved","Array","length","fill","forEach","then","catch","finally","slice","Error","concat","JSON","stringify","message","q","A","C","keys","getOwnPropertySymbols","filter","getOwnPropertyDescriptor","push","apply","K","arguments","getOwnPropertyDescriptors","defineProperties","M","from","reduce","E","X","map","post","generateJsonRPCObject","verifier","verifier_id","toString","error","result","resolve","keyResult","errorResult","reject","Y","setTimeout","J","Math","floor","random","headers","pubKeyX","pubKeyY","useAPIKey","I","R","N","enableLogging","metadataHost","allowHost","ec","metadataCache","disableAll","metadataLock","key","mark","wrap","prev","next","generatePrivate","getPublic","keccak256","messageprefix","tokencommitment","temppubx","temppuby","verifieridentifier","abrupt","encrypted","item","idtoken","nodesignatures","PublicKey","sort","Index","cmp","Metadata","ephemPublicKey","Buffer","iv","mac","mode","decrypt","ciphertext","atob","Share","padStart","debug","all","sent","index","includes","lagrangeInterpolation","getMetadata","pub_key_X","pub_key_Y","add","umod","curve","generateAddressFromPrivKey","ethAddress","privKey","metadataNonce","stop","put","t0","keyFromPrivate","data","timestamp","Date","now","sign","getX","getY","set_data","signature","del","mul","neg","sub","invm","encode","toChecksumAddress","keyFromPublic","verifierId","t1","generateAddressFromPubKey","address","setAPIKey","setEmbedHost"],"mappings":"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","sourcesContent":["module.exports=function(e){var t={};function r(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&\"object\"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,\"default\",{enumerable:!0,value:e}),2&t&&\"string\"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,\"a\",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p=\"\",r(r.s=15)}([function(e,t){e.exports=require(\"bn.js\")},function(e,t){e.exports=require(\"@babel/runtime/regenerator\")},function(e,t){e.exports=require(\"@toruslabs/http-helpers\")},function(e,t){e.exports=require(\"web3-utils\")},function(e,t){e.exports=require(\"json-stable-stringify\")},function(e,t){e.exports=require(\"@babel/runtime/helpers/asyncToGenerator\")},function(e,t){e.exports=require(\"@toruslabs/eccrypto\")},function(e,t){e.exports=require(\"@babel/runtime/helpers/defineProperty\")},function(e,t){e.exports=require(\"@babel/runtime/helpers/toConsumableArray\")},function(e,t){e.exports=require(\"@babel/runtime/helpers/typeof\")},function(e,t){e.exports=require(\"@babel/runtime/helpers/classCallCheck\")},function(e,t){e.exports=require(\"@babel/runtime/helpers/createClass\")},function(e,t){e.exports=require(\"elliptic\")},function(e,t){e.exports=require(\"memory-cache\")},function(e,t){e.exports=require(\"loglevel\")},function(e,t,r){\"use strict\";r.r(t);var n=r(1),a=r.n(n),o=r(7),i=r.n(o),u=r(9),c=r.n(u),s=r(5),f=r.n(s),l=r(10),p=r.n(l),h=r(11),b=r.n(h),d=r(6),g=r(2),m=r(0),v=r.n(m),y=r(12),k=r(4),x=r.n(k),O=r(13),w=r.n(O),P=r(3),j=r(14),S=r.n(j).a.getLogger(\"torus.js\"),_=function(e,t){return new Promise((function(r,n){var a,o=0,i={resolved:!1},u=new Array(e.length).fill(void 0),c=new Array(e.length).fill(void 0);e.forEach((function(s,f){s.then((function(e){c[f]=e})).catch((function(e){u[f]=e})).finally((function(){i.resolved||t(c.slice(0),i).then((function(e){i.resolved=!0,r(e)})).catch((function(e){a=e})).finally((function(t){var r;(o+=1)===e.length&&n(new Error(\"Unable to resolve enough promises, errors: \".concat(JSON.stringify(u),\", responses: \").concat(JSON.stringify(c),\", predicate: \").concat((null===(r=a)||void 0===r?void 0:r.message)||a)))}))}))}))}))},q=r(8),A=r.n(q);function C(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function K(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?C(Object(r),!0).forEach((function(t){i()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):C(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var M=function e(t,r){var n=t;if(\"number\"==typeof n&&(n=Array.from({length:n},(function(e,t){return t}))),r>n.length||r<=0)return[];if(r===n.length)return[n];if(1===r)return n.reduce((function(e,t){return[].concat(A()(e),[[t]])}),[]);for(var a=[],o=[],i=0;i<=n.length-r+1;i+=1){o=e(n.slice(i+1),r-1);for(var u=0;u<o.length;u+=1)a.push([n[i]].concat(A()(o[u])))}return a},E=function(e,t){for(var r={},n=0;n<e.length;n+=1){var a=x()(e[n]);if(r[a]=r[a]?r[a]+1:1,r[a]===t)return e[n]}},X=function(e,t,r){var n=e.map((function(e){return Object(g.post)(e,Object(g.generateJsonRPCObject)(\"VerifierLookupRequest\",{verifier:t,verifier_id:r.toString()})).catch((function(e){return S.error(\"lookup request failed\",e)}))}));return _(n,(function(t){var r=t.filter((function(e){return e})),n=E(r.map((function(e){return e&&e.error})),1+~~(e.length/2)),a=E(r.map((function(e){return e&&e.result})),1+~~(e.length/2));return a||n?Promise.resolve({keyResult:a,errorResult:n}):Promise.reject(new Error(\"invalid results \".concat(JSON.stringify(t))))})).catch((function(e){return S.error(\"Some for keylookup failed\",e)}))},Y=function(e,t,r,n){return new Promise((function(a,o){setTimeout((function(){X(e,t,r).then(a).catch(o)}),n)}))},J=function e(t,r,n,a,o,i){var u,c;if(void 0===n?(u=Math.floor(Math.random()*t.length),c=u):u=n%t.length,u===a)throw new Error(\"Looped through all\");void 0!==a&&(c=a);var s=Object(g.generateJsonRPCObject)(\"KeyAssign\",{verifier:o,verifier_id:i.toString()});return Object(g.post)(\"https://signer.tor.us/api/sign\",s,{headers:{pubKeyX:r[u].X,pubKeyY:r[u].Y}},{useAPIKey:!0}).then((function(n){return Object(g.post)(t[u],K(K({},s),n),{headers:{\"Content-Type\":\"application/json; charset=utf-8\"}}).catch((function(n){return e(t,r,u+1,c,o,i)}))}))};function I(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function R(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?I(Object(r),!0).forEach((function(t){i()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):I(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var N=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.enableLogging,n=void 0!==r&&r,a=t.metadataHost,o=void 0===a?\"https://metadata.tor.us\":a,i=t.allowHost,u=void 0===i?\"https://signer.tor.us/api/allow\":i;p()(this,e),this.ec=new y.ec(\"secp256k1\"),this.metadataHost=o,this.allowHost=u,this.metadataCache=w.a,n||S.disableAll(),this.metadataLock={}}var t,r,n,o;return b()(e,[{key:\"retrieveShares\",value:(o=f()(a.a.mark((function e(t,r,n,o,i){var u,s,l,p,h,b,m,y,k,x=this,O=arguments;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=O.length>5&&void 0!==O[5]?O[5]:{},s=[],e.next=4,Object(g.get)(this.allowHost,{},{useAPIKey:!0});case 4:for(l=Object(d.generatePrivate)(),p=Object(d.getPublic)(l).toString(\"hex\"),h=p.slice(2,66),b=p.slice(66),m=Object(P.keccak256)(i),y=0;y<t.length;y+=1)k=Object(g.post)(t[y],Object(g.generateJsonRPCObject)(\"CommitmentRequest\",{messageprefix:\"mug00\",tokencommitment:m.slice(2),temppubx:h,temppuby:b,verifieridentifier:n})).catch((function(e){return S.error(\"commitment\",e)})),s.push(k);return e.abrupt(\"return\",_(s,(function(e){return e.filter((function(e){return!(!e||\"object\"!==c()(e)||e.error)})).length>=3*~~(t.length/4)+1?Promise.resolve(e):Promise.reject(new Error(\"invalid \".concat(JSON.stringify(e))))})).then((function(e){for(var c=[],s=[],p=0;p<e.length;p+=1)e[p]&&s.push(e[p].result);for(var h=0;h<t.length;h+=1){var b=Object(g.post)(t[h],Object(g.generateJsonRPCObject)(\"ShareRequest\",{encrypted:\"yes\",item:[R(R({},o),{},{idtoken:i,nodesignatures:s,verifieridentifier:n},u)]})).catch((function(e){return S.error(\"share req\",e)}));c.push(b)}return _(c,function(){var e=f()(a.a.mark((function e(n,o){var i,u,c,s,f,p,h,b,g,m,y,k,O,w;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=n.filter((function(e){return e})),u=E(n.map((function(e){return e&&e.result&&e.result.keys[0].PublicKey})),1+~~(t.length/2)),!(i.length>=1+~~(t.length/2)&&u)){e.next=32;break}for(c=[],s=[],f=0;f<n.length;f+=1)n[f]&&n[f].result&&n[f].result.keys&&n[f].result.keys.length>0?(n[f].result.keys.sort((function(e,t){return new v.a(e.Index,16).cmp(new v.a(t.Index,16))})),n[f].result.keys[0].Metadata?(p={ephemPublicKey:Buffer.from(n[f].result.keys[0].Metadata.ephemPublicKey,\"hex\"),iv:Buffer.from(n[f].result.keys[0].Metadata.iv,\"hex\"),mac:Buffer.from(n[f].result.keys[0].Metadata.mac,\"hex\"),mode:Buffer.from(n[f].result.keys[0].Metadata.mode,\"hex\")},c.push(Object(d.decrypt)(l,R(R({},p),{},{ciphertext:Buffer.from(atob(n[f].result.keys[0].Share).padStart(64,\"0\"),\"hex\")})).catch((function(e){return S.debug(\"share decryption\",e)})))):c.push(Promise.resolve(Buffer.from(n[f].result.keys[0].Share.padStart(64,\"0\"),\"hex\")))):c.push(Promise.resolve(void 0)),s.push(new v.a(r[f],16));return e.next=8,Promise.all(c);case 8:if(h=e.sent,!o.resolved){e.next=11;break}return e.abrupt(\"return\",void 0);case 11:b=h.reduce((function(e,t,r){return t&&e.push({index:s[r],value:new v.a(t)}),e}),[]),g=M(b.length,1+~~(t.length/2)),y=function(e){var t=g[e],r=b.filter((function(e,r){return t.includes(r)})),n=r.map((function(e){return e.value})),a=r.map((function(e){return e.index})),o=x.lagrangeInterpolation(n,a),i=Object(d.getPublic)(Buffer.from(o.toString(16,64),\"hex\")).toString(\"hex\"),c=i.slice(2,66),s=i.slice(66);if(0===new v.a(c,16).cmp(new v.a(u.X,16))&&0===new v.a(s,16).cmp(new v.a(u.Y,16)))return m=o,\"break\"},k=0;case 15:if(!(k<g.length)){e.next=22;break}if(\"break\"!==y(k)){e.next=19;break}return e.abrupt(\"break\",22);case 19:k+=1,e.next=15;break;case 22:if(void 0!==m){e.next=24;break}throw new Error(\"could not derive private key\");case 24:return e.next=26,x.getMetadata({pub_key_X:u.X,pub_key_Y:u.Y});case 26:if(O=e.sent,!o.resolved){e.next=29;break}return e.abrupt(\"return\",void 0);case 29:return m=m.add(O).umod(x.ec.curve.n),w=x.generateAddressFromPrivKey(m),e.abrupt(\"return\",{ethAddress:w,privKey:m.toString(\"hex\",64),metadataNonce:O});case 32:throw new Error(\"invalid\");case 33:case\"end\":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}())})));case 11:case\"end\":return e.stop()}}),e,this)}))),function(e,t,r,n,a){return o.apply(this,arguments)})},{key:\"getMetadata\",value:(n=f()(a.a.mark((function e(t,r){var n,o,i,u,c=this;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,o=x()(t),null===this.metadataLock[o]){e.next=7;break}return e.next=5,this.metadataLock[o];case 5:e.next=8;break;case 7:this.metadataLock[o]=new Promise((function(e){n=function(){c.metadataLock[o]=null,e()}}));case 8:if(null===(i=this.metadataCache.get(o))){e.next=12;break}return n&&n(),e.abrupt(\"return\",i);case 12:return e.next=14,Object(g.post)(\"\".concat(this.metadataHost,\"/get\"),t,r,{useAPIKey:!0});case 14:if((u=e.sent)&&u.message){e.next=19;break}return this.metadataCache.put(o,new v.a(0),6e4),n&&n(),e.abrupt(\"return\",new v.a(0));case 19:return this.metadataCache.put(o,new v.a(u.message,16),6e4),e.abrupt(\"return\",new v.a(u.message,16));case 23:return e.prev=23,e.t0=e.catch(0),S.error(\"get metadata error\",e.t0),n&&n(),e.abrupt(\"return\",new v.a(0));case 28:case\"end\":return e.stop()}}),e,this,[[0,23]])}))),function(e,t){return n.apply(this,arguments)})},{key:\"generateMetadataParams\",value:function(e,t){var r=this.ec.keyFromPrivate(t.toString(\"hex\",64)),n={data:e,timestamp:new v.a(~~(Date.now()/1e3)).toString(16)},a=r.sign(Object(P.keccak256)(x()(n)).slice(2));return{pub_key_X:r.getPublic().getX().toString(\"hex\"),pub_key_Y:r.getPublic().getY().toString(\"hex\"),set_data:n,signature:Buffer.from(a.r.toString(16,64)+a.s.toString(16,64)+new v.a(a.v).toString(16,2),\"hex\").toString(\"base64\")}}},{key:\"setMetadata\",value:(r=f()(a.a.mark((function e(t,r){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.metadataCache.del(x()({pub_key_X:t.pub_key_X,pub_key_Y:t.pub_key_Y})),e.next=4,Object(g.post)(\"\".concat(this.metadataHost,\"/set\"),t,r,{useAPIKey:!0});case 4:return n=e.sent,e.abrupt(\"return\",n.message);case 8:return e.prev=8,e.t0=e.catch(0),S.error(\"set metadata error\",e.t0),e.abrupt(\"return\",\"\");case 12:case\"end\":return e.stop()}}),e,this,[[0,8]])}))),function(e,t){return r.apply(this,arguments)})},{key:\"lagrangeInterpolation\",value:function(e,t){if(e.length!==t.length)return null;for(var r=new v.a(0),n=0;n<e.length;n+=1){for(var a=new v.a(1),o=new v.a(1),i=0;i<e.length;i+=1)if(n!==i){a=(a=a.mul(t[i].neg())).umod(this.ec.curve.n);var u=t[n].sub(t[i]);u=u.umod(this.ec.curve.n),o=o.mul(u).umod(this.ec.curve.n)}var c=a.mul(o.invm(this.ec.curve.n)).umod(this.ec.curve.n);c=c.mul(e[n]).umod(this.ec.curve.n),r=r.add(c)}return r.umod(this.ec.curve.n)}},{key:\"generateAddressFromPrivKey\",value:function(e){var t=this.ec.keyFromPrivate(e.toString(\"hex\",64),\"hex\").getPublic().encode(\"hex\").slice(2),r=\"0x\".concat(Object(P.keccak256)(Buffer.from(t,\"hex\")).slice(26));return Object(P.toChecksumAddress)(r)}},{key:\"generateAddressFromPubKey\",value:function(e,t){var r=this.ec.keyFromPublic({x:e.toString(\"hex\",64),y:t.toString(\"hex\",64)}).getPublic().encode(\"hex\").slice(2),n=\"0x\".concat(Object(P.keccak256)(Buffer.from(r,\"hex\")).slice(26));return Object(P.toChecksumAddress)(n)}},{key:\"getPublicAddress\",value:(t=f()(a.a.mark((function e(t,r,n){var o,i,u,c,s,f,l,p,h,b,d,g,m,v,y=arguments;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=n.verifier,i=n.verifierId,u=y.length>3&&void 0!==y[3]&&y[3],e.next=4,X(t,o,i);case 4:if(e.t0=e.sent,e.t0){e.next=7;break}e.t0={};case 7:if(s=e.t0,f=s.keyResult,!(l=s.errorResult)||!JSON.stringify(l).includes(\"Verifier + VerifierID has not yet been assigned\")){e.next=22;break}return e.next=13,J(t,r,void 0,void 0,o,i);case 13:return e.next=15,Y(t,o,i,1e3);case 15:if(e.t1=e.sent,e.t1){e.next=18;break}e.t1={};case 18:p=e.t1,c=p.keyResult,e.next=27;break;case 22:if(!f){e.next=26;break}c=f,e.next=27;break;case 26:throw new Error(\"node results do not match at first lookup \".concat(JSON.stringify(f||{}),\", \").concat(JSON.stringify(l||{})));case 27:if(!c){e.next=39;break}return h=c.keys[0],b=h.pub_key_X,d=h.pub_key_Y,e.next=31,this.getMetadata({pub_key_X:b,pub_key_Y:d});case 31:if(g=e.sent,m=this.ec.keyFromPublic({x:b.toString(16),y:d.toString(16)}).getPublic().add(this.ec.keyFromPrivate(g.toString(16)).getPublic()),b=m.getX().toString(16),d=m.getY().toString(16),v=this.generateAddressFromPubKey(m.getX(),m.getY()),u){e.next=38;break}return e.abrupt(\"return\",v);case 38:return e.abrupt(\"return\",{address:v,X:b,Y:d,metadataNonce:g});case 39:throw new Error(\"node results do not match at final lookup \".concat(JSON.stringify(f||{}),\", \").concat(JSON.stringify(l||{})));case 40:case\"end\":return e.stop()}}),e,this)}))),function(e,r,n){return t.apply(this,arguments)})}],[{key:\"setAPIKey\",value:function(e){Object(g.setAPIKey)(e)}},{key:\"setEmbedHost\",value:function(e){Object(g.setEmbedHost)(e)}}]),e}();t.default=N}]).default;"]},"metadata":{},"sourceType":"script"}