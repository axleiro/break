{"ast":null,"code":"var _jsxFileName = \"/Users/jstarry/Workspace/solana/break/client/src/components/TxContainer.tsx\";\nimport React, { useRef, useEffect, useCallback } from \"react\";\nimport { useThrottle } from \"@react-hook/throttle\";\nimport { TransactionSquare } from \"./TxSquare\";\nimport { useCreateTxRef, useTransactions } from \"providers/transactions\";\nimport { useGameState, useResetGame, COUNTDOWN_SECS, useCountdown } from \"providers/game\";\nimport { TxTableRow } from \"./TxTableRow\";\nimport { DEBUG_MODE } from \"providers/transactions/confirmed\";\nexport function TransactionContainer({\n  enabled\n}) {\n  console.log(\"RENDER\");\n  const scrollEl = useRef(null);\n  const rawTransactions = useTransactions();\n  const [transactions, setTransactions] = useThrottle(rawTransactions, 2);\n  const createTx = useCreateTxRef();\n  const gameState = useGameState();\n  const [countdown, setCountdown] = useCountdown();\n  const resetGame = useResetGame();\n  const [rapidFire, setRapidFire] = React.useState(false);\n  console.log({\n    gameState,\n    countdown,\n    rapidFire\n  });\n  const makeTransaction = useCallback(() => {\n    if (enabled) {\n      if (countdown !== undefined) {\n        createTx.current();\n      } else if (gameState === \"play\") {\n        createTx.current();\n        setCountdown(performance.now());\n      }\n    }\n  }, [enabled, createTx, gameState, countdown, setCountdown]); // Notify throttler of latest transactions\n\n  useEffect(() => {\n    setTransactions(rawTransactions);\n  }, [rawTransactions, setTransactions]);\n  useEffect(() => {\n    if (rapidFire && !enabled) {\n      setRapidFire(false);\n      return;\n    } else if (!rapidFire) {\n      return;\n    }\n\n    let intervalId;\n    const timeoutId = setTimeout(() => {\n      intervalId = setInterval(() => {\n        makeTransaction();\n      }, 30);\n    }, 300);\n    return () => {\n      clearTimeout(timeoutId);\n      clearInterval(intervalId);\n    };\n  }, [rapidFire, enabled, makeTransaction]);\n  useEffect(() => {\n    const testMode = new URLSearchParams(window.location.search).has(\"test\");\n    if (!testMode) return;\n    const testInterval = window.setInterval(() => makeTransaction(), 30);\n    return () => clearInterval(testInterval);\n  }, [makeTransaction]);\n  useEffect(() => {\n    document.addEventListener(\"keyup\", makeTransaction);\n    return () => {\n      document.removeEventListener(\"keyup\", makeTransaction);\n    };\n  }, [makeTransaction]);\n  useEffect(() => {\n    const current = scrollEl.current;\n\n    if (current) {\n      current.scrollTop = current.scrollHeight;\n    }\n  }, [transactions.length]);\n  const renderTransactions = DEBUG_MODE ? /*#__PURE__*/React.createElement(\"div\", {\n    className: \"table-responsive mb-0\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"table\", {\n    className: \"table table-sm table-nowrap\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"thead\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"tr\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"th\", {\n    className: \"text-muted\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 13\n    }\n  }, \"Transaction\"), /*#__PURE__*/React.createElement(\"th\", {\n    className: \"text-muted\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 13\n    }\n  }, \"Target Slot\"), /*#__PURE__*/React.createElement(\"th\", {\n    className: \"text-muted\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 13\n    }\n  }, \"Landed Slot\"), /*#__PURE__*/React.createElement(\"th\", {\n    className: \"text-muted\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 13\n    }\n  }, \"Recent Conf Time\"), /*#__PURE__*/React.createElement(\"th\", {\n    className: \"text-muted\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 13\n    }\n  }, \"SingleGossip Conf Time\"), /*#__PURE__*/React.createElement(\"th\", {\n    className: \"text-muted\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 13\n    }\n  }, \"Single Conf Time\"))), /*#__PURE__*/React.createElement(\"tbody\", {\n    className: \"list\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 9\n    }\n  }, transactions.map(tx => /*#__PURE__*/React.createElement(TxTableRow, {\n    key: tx.details.signature,\n    transaction: tx,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 13\n    }\n  }))))) : transactions.map(tx => /*#__PURE__*/React.createElement(TransactionSquare, {\n    key: tx.details.signature,\n    transaction: tx,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 7\n    }\n  }));\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"card h-100 mb-0\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"card-header\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"d-flex align-items-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(HelpButton, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(\"span\", {\n    className: \"text-truncate\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 11\n    }\n  }, \"Live Transaction Statuses\")), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"text-primary d-none d-md-block\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 9\n    }\n  }, enabled ? \"Press any key to send a transaction\" : \"Game finished\")), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"card-body\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"tx-wrapper border-1 border-primary h-100 position-relative\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 9\n    }\n  }, !transactions.length && enabled ? /*#__PURE__*/React.createElement(\"div\", {\n    className: \"d-flex h-100 justify-content-center align-items-center p-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    className: \"text-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 15\n    }\n  }, \"Try to break Solana's network by sending as many transactions as you can in \", COUNTDOWN_SECS, \" seconds!\")) : null, /*#__PURE__*/React.createElement(\"div\", {\n    ref: scrollEl,\n    className: \"square-container\",\n    tabIndex: 0,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 11\n    }\n  }, renderTransactions))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"card-footer\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: \"btn btn-pink w-100 text-uppercase text-truncate touch-action-none\",\n    onContextMenu: e => e.preventDefault(),\n    onPointerDown: () => setRapidFire(true),\n    onPointerUp: () => setRapidFire(false),\n    onPointerLeave: () => setRapidFire(false),\n    onPointerCancel: () => setRapidFire(false),\n    onClick: enabled ? makeTransaction : resetGame,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: `fe fe-${enabled ? \"zap\" : \"repeat\"} mr-2`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 148,\n      columnNumber: 11\n    }\n  }), enabled ? \"Send new transactions\" : \"Play again\")));\n}\n\nfunction Legend({\n  show\n}) {\n  if (!show) return null;\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"popover bs-popover-bottom right show\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 159,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"arrow\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 160,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"popover-body\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 161,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"d-flex flex-column\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 162,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"d-flex align-items-center mb-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 163,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"btn square legend slideInRight btn-dark mr-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 164,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 165,\n      columnNumber: 13\n    }\n  }, \"Pending transaction\")), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"d-flex align-items-center mb-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 168,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"btn square legend slideInRight btn-primary mr-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 170,\n      columnNumber: 13\n    }\n  }, \"Confirmed transaction\")), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"d-flex align-items-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 173,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"btn square legend slideInRight btn-danger mr-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 13\n    }\n  }, \"Failed transaction\")))));\n}\n\nfunction HelpButton() {\n  const [show, setShow] = React.useState(false);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"popover-container c-pointer mr-3\",\n    onClick: () => setShow(true),\n    onMouseOver: () => setShow(true),\n    onMouseOut: () => setShow(false),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: \"fe fe-help-circle\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 193,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(Legend, {\n    show: show,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 194,\n      columnNumber: 7\n    }\n  }));\n}","map":{"version":3,"sources":["/Users/jstarry/Workspace/solana/break/client/src/components/TxContainer.tsx"],"names":["React","useRef","useEffect","useCallback","useThrottle","TransactionSquare","useCreateTxRef","useTransactions","useGameState","useResetGame","COUNTDOWN_SECS","useCountdown","TxTableRow","DEBUG_MODE","TransactionContainer","enabled","console","log","scrollEl","rawTransactions","transactions","setTransactions","createTx","gameState","countdown","setCountdown","resetGame","rapidFire","setRapidFire","useState","makeTransaction","undefined","current","performance","now","intervalId","timeoutId","setTimeout","setInterval","clearTimeout","clearInterval","testMode","URLSearchParams","window","location","search","has","testInterval","document","addEventListener","removeEventListener","scrollTop","scrollHeight","length","renderTransactions","map","tx","details","signature","e","preventDefault","Legend","show","HelpButton","setShow"],"mappings":"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","sourcesContent":["import React, { useRef, useEffect, useCallback } from \"react\";\nimport { useThrottle } from \"@react-hook/throttle\";\n\nimport { TransactionSquare } from \"./TxSquare\";\nimport { useCreateTxRef, useTransactions, TransactionState } from \"providers/transactions\";\nimport {\n  useGameState,\n  useResetGame,\n  COUNTDOWN_SECS,\n  useCountdown,\n} from \"providers/game\";\nimport { TxTableRow } from \"./TxTableRow\";\nimport { DEBUG_MODE } from \"providers/transactions/confirmed\";\n\nexport function TransactionContainer({ enabled }: { enabled?: boolean }) {\n  console.log(\"RENDER\");\n  const scrollEl = useRef<HTMLDivElement>(null);\n  const rawTransactions = useTransactions();\n  const [transactions, setTransactions] = useThrottle(rawTransactions, 2);\n\n  const createTx = useCreateTxRef();\n  const gameState = useGameState();\n  const [countdown, setCountdown] = useCountdown();\n  const resetGame = useResetGame();\n  const [rapidFire, setRapidFire] = React.useState(false);\n  console.log({gameState, countdown, rapidFire});\n\n  const makeTransaction = useCallback(() => {\n    if (enabled) {\n      if (countdown !== undefined) {\n        createTx.current();\n      } else if (gameState === \"play\") {\n        createTx.current();\n        setCountdown(performance.now());\n      }\n    }\n  }, [enabled, createTx, gameState, countdown, setCountdown]);\n\n  // Notify throttler of latest transactions\n  useEffect(() => {\n    setTransactions(rawTransactions);\n  }, [rawTransactions, setTransactions]);\n\n  useEffect(() => {\n    if (rapidFire && !enabled) {\n      setRapidFire(false);\n      return;\n    } else if (!rapidFire) {\n      return;\n    }\n\n    let intervalId: NodeJS.Timeout;\n    const timeoutId = setTimeout(() => {\n      intervalId = setInterval(() => {\n        makeTransaction();\n      }, 30);\n    }, 300);\n\n    return () => {\n      clearTimeout(timeoutId);\n      clearInterval(intervalId);\n    };\n  }, [rapidFire, enabled, makeTransaction]);\n\n  useEffect(() => {\n    const testMode = new URLSearchParams(window.location.search).has(\"test\");\n    if (!testMode) return;\n    const testInterval = window.setInterval(() => makeTransaction(), 30);\n    return () => clearInterval(testInterval);\n  }, [makeTransaction]);\n\n  useEffect(() => {\n    document.addEventListener(\"keyup\", makeTransaction);\n    return () => {\n      document.removeEventListener(\"keyup\", makeTransaction);\n    };\n  }, [makeTransaction]);\n\n  useEffect(() => {\n    const current = scrollEl.current;\n    if (current) {\n      current.scrollTop = current.scrollHeight;\n    }\n  }, [transactions.length]);\n\n  const renderTransactions = DEBUG_MODE ? (\n    <div className=\"table-responsive mb-0\">\n      <table className=\"table table-sm table-nowrap\">\n        <thead>\n          <tr>\n            <th className=\"text-muted\">Transaction</th>\n            <th className=\"text-muted\">Target Slot</th>\n            <th className=\"text-muted\">Landed Slot</th>\n            <th className=\"text-muted\">Recent Conf Time</th>\n            <th className=\"text-muted\">SingleGossip Conf Time</th>\n            <th className=\"text-muted\">Single Conf Time</th>\n          </tr>\n        </thead>\n        <tbody className=\"list\">\n          {transactions.map((tx) => (\n            <TxTableRow key={tx.details.signature} transaction={tx} />\n          ))}\n        </tbody>\n      </table>\n    </div>\n  ) : (\n    transactions.map((tx) => (\n      <TransactionSquare key={tx.details.signature} transaction={tx} />\n    ))\n  );\n\n  return (\n    <div className=\"card h-100 mb-0\">\n      <div className=\"card-header\">\n        <div className=\"d-flex align-items-center\">\n          <HelpButton />\n          <span className=\"text-truncate\">Live Transaction Statuses</span>\n        </div>\n        <div className=\"text-primary d-none d-md-block\">\n          {enabled ? \"Press any key to send a transaction\" : \"Game finished\"}\n        </div>\n      </div>\n      <div className=\"card-body\">\n        <div className=\"tx-wrapper border-1 border-primary h-100 position-relative\">\n          {!transactions.length && enabled ? (\n            <div className=\"d-flex h-100 justify-content-center align-items-center p-3\">\n              <h2 className=\"text-center\">\n                Try to break Solana's network by sending as many transactions as\n                you can in {COUNTDOWN_SECS} seconds!\n              </h2>\n            </div>\n          ) : null}\n          <div ref={scrollEl} className=\"square-container\" tabIndex={0}>\n            {renderTransactions}\n          </div>\n        </div>\n      </div>\n      <div className=\"card-footer\">\n        <span\n          className=\"btn btn-pink w-100 text-uppercase text-truncate touch-action-none\"\n          onContextMenu={(e) => e.preventDefault()}\n          onPointerDown={() => setRapidFire(true)}\n          onPointerUp={() => setRapidFire(false)}\n          onPointerLeave={() => setRapidFire(false)}\n          onPointerCancel={() => setRapidFire(false)}\n          onClick={enabled ? makeTransaction : resetGame}\n        >\n          <span className={`fe fe-${enabled ? \"zap\" : \"repeat\"} mr-2`}></span>\n          {enabled ? \"Send new transactions\" : \"Play again\"}\n        </span>\n      </div>\n    </div>\n  );\n}\n\nfunction Legend({ show }: { show: boolean }) {\n  if (!show) return null;\n  return (\n    <div className=\"popover bs-popover-bottom right show\">\n      <div className=\"arrow\" />\n      <div className=\"popover-body\">\n        <div className=\"d-flex flex-column\">\n          <div className=\"d-flex align-items-center mb-3\">\n            <div className=\"btn square legend slideInRight btn-dark mr-2\" />\n            <span>Pending transaction</span>\n          </div>\n\n          <div className=\"d-flex align-items-center mb-3\">\n            <div className=\"btn square legend slideInRight btn-primary mr-2\" />\n            <span>Confirmed transaction</span>\n          </div>\n\n          <div className=\"d-flex align-items-center\">\n            <div className=\"btn square legend slideInRight btn-danger mr-2\" />\n            <span>Failed transaction</span>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nfunction HelpButton() {\n  const [show, setShow] = React.useState(false);\n\n  return (\n    <div\n      className=\"popover-container c-pointer mr-3\"\n      onClick={() => setShow(true)}\n      onMouseOver={() => setShow(true)}\n      onMouseOut={() => setShow(false)}\n    >\n      <span className=\"fe fe-help-circle\"></span>\n      <Legend show={show} />\n    </div>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}