{"ast":null,"code":"var _jsxFileName = \"/Users/jstarry/Workspace/solana/break/client/src/components/TxContainer.tsx\";\nimport React, { useRef, useEffect, useCallback } from \"react\";\nimport { useThrottle } from \"@react-hook/throttle\";\nimport { TransactionSquare } from \"./TxSquare\";\nimport { useCreateTx, useTransactions } from \"providers/transactions\";\nimport { useGameState, useResetGame, COUNTDOWN_SECS, useCountdown } from \"providers/game\";\nexport function TransactionContainer({\n  enabled\n}) {\n  const scrollEl = useRef(null);\n  const rawTransactions = useTransactions();\n  const [transactions, setTransactions] = useThrottle(rawTransactions, 10);\n  const createTx = useCreateTx();\n  const [gameState] = useGameState();\n  const [countdown, setCountdown] = useCountdown();\n  const resetGame = useResetGame();\n  const [rapidFire, setRapidFire] = React.useState(false);\n  const makeTransaction = useCallback(() => {\n    if (enabled) {\n      if (countdown !== undefined) {\n        createTx();\n      } else if (gameState === \"play\") {\n        createTx();\n        setCountdown(performance.now());\n      }\n    }\n  }, [enabled, createTx, gameState, countdown, setCountdown]);\n  useEffect(() => {\n    if (!rapidFire || !enabled) {\n      setRapidFire(false);\n      return;\n    }\n\n    let intervalId;\n    const timeoutId = setTimeout(() => {\n      intervalId = setInterval(() => {\n        makeTransaction();\n      }, 30);\n    }, 300);\n    return () => {\n      clearTimeout(timeoutId);\n      clearInterval(intervalId);\n    };\n  }, [rapidFire, enabled, makeTransaction]);\n  useEffect(() => {\n    const testMode = new URLSearchParams(window.location.search).has(\"test\");\n    if (!testMode) return;\n    const testInterval = window.setInterval(() => makeTransaction(), 30);\n    return () => clearInterval(testInterval);\n  }, [makeTransaction]);\n  useEffect(() => {\n    document.addEventListener(\"keyup\", makeTransaction);\n    return () => {\n      document.removeEventListener(\"keyup\", makeTransaction);\n    };\n  }, [makeTransaction]);\n  useEffect(() => {\n    setTransactions(rawTransactions);\n  }, [rawTransactions, setTransactions]);\n  useEffect(() => {\n    const current = scrollEl.current;\n\n    if (current) {\n      current.scrollTop = current.scrollHeight;\n    }\n  }, [transactions.length]);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"card h-100 mb-0\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"card-header\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"d-flex align-items-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(HelpButton, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(\"span\", {\n    className: \"text-truncate\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 11\n    }\n  }, \"Live Transaction Statuses\")), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"text-primary d-none d-md-block\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 9\n    }\n  }, enabled ? \"Press any key to send a transaction\" : \"Game finished\")), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"card-body\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"tx-wrapper border-1 border-primary h-100 position-relative\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 9\n    }\n  }, !transactions.length && enabled ? /*#__PURE__*/React.createElement(\"div\", {\n    className: \"d-flex h-100 justify-content-center align-items-center p-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    className: \"text-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 15\n    }\n  }, \"Try to break Solana's network by sending as many transactions as you can in \", COUNTDOWN_SECS, \" seconds!\")) : null, /*#__PURE__*/React.createElement(\"div\", {\n    ref: scrollEl,\n    className: \"square-container\",\n    tabIndex: 0,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 11\n    }\n  }, transactions.map(tx => /*#__PURE__*/React.createElement(TransactionSquare, {\n    key: tx.details.signature,\n    transaction: tx,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 15\n    }\n  }))))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"card-footer\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: \"btn btn-pink w-100 text-uppercase text-truncate touch-action-none\",\n    onContextMenu: e => e.preventDefault(),\n    onPointerDown: () => setRapidFire(true),\n    onPointerUp: () => setRapidFire(false),\n    onPointerLeave: () => setRapidFire(false),\n    onPointerCancel: () => setRapidFire(false),\n    onClick: enabled ? makeTransaction : resetGame,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: `fe fe-${enabled ? \"zap\" : \"repeat\"} mr-2`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 11\n    }\n  }), enabled ? \"Send new transactions\" : \"Play again\")));\n}\n\nfunction Legend({\n  show\n}) {\n  if (!show) return null;\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"popover bs-popover-bottom right show\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"arrow\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"popover-body\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"d-flex flex-column\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"d-flex align-items-center mb-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"btn square legend slideInRight btn-dark mr-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 13\n    }\n  }, \"Pending transaction\")), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"d-flex align-items-center mb-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"btn square legend slideInRight btn-primary mr-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 13\n    }\n  }, \"Confirmed transaction\")), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"d-flex align-items-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"btn square legend slideInRight btn-danger mr-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 13\n    }\n  }, \"Failed transaction\")))));\n}\n\nfunction HelpButton() {\n  const [show, setShow] = React.useState(false);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"popover-container c-pointer mr-3\",\n    onClick: () => setShow(true),\n    onMouseOver: () => setShow(true),\n    onMouseOut: () => setShow(false),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: \"fe fe-help-circle\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 161,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(Legend, {\n    show: show,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 162,\n      columnNumber: 7\n    }\n  }));\n}","map":{"version":3,"sources":["/Users/jstarry/Workspace/solana/break/client/src/components/TxContainer.tsx"],"names":["React","useRef","useEffect","useCallback","useThrottle","TransactionSquare","useCreateTx","useTransactions","useGameState","useResetGame","COUNTDOWN_SECS","useCountdown","TransactionContainer","enabled","scrollEl","rawTransactions","transactions","setTransactions","createTx","gameState","countdown","setCountdown","resetGame","rapidFire","setRapidFire","useState","makeTransaction","undefined","performance","now","intervalId","timeoutId","setTimeout","setInterval","clearTimeout","clearInterval","testMode","URLSearchParams","window","location","search","has","testInterval","document","addEventListener","removeEventListener","current","scrollTop","scrollHeight","length","map","tx","details","signature","e","preventDefault","Legend","show","HelpButton","setShow"],"mappings":"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","sourcesContent":["import React, { useRef, useEffect, useCallback } from \"react\";\nimport { useThrottle } from \"@react-hook/throttle\";\n\nimport { TransactionSquare } from \"./TxSquare\";\nimport { useCreateTx, useTransactions } from \"providers/transactions\";\nimport {\n  useGameState,\n  useResetGame,\n  COUNTDOWN_SECS,\n  useCountdown,\n} from \"providers/game\";\n\nexport function TransactionContainer({ enabled }: { enabled?: boolean }) {\n  const scrollEl = useRef<HTMLDivElement>(null);\n  const rawTransactions = useTransactions();\n  const [transactions, setTransactions] = useThrottle(rawTransactions, 10);\n  const createTx = useCreateTx();\n  const [gameState] = useGameState();\n  const [countdown, setCountdown] = useCountdown();\n  const resetGame = useResetGame();\n  const [rapidFire, setRapidFire] = React.useState(false);\n\n  const makeTransaction = useCallback(() => {\n    if (enabled) {\n      if (countdown !== undefined) {\n        createTx();\n      } else if (gameState === \"play\") {\n        createTx();\n        setCountdown(performance.now());\n      }\n    }\n  }, [enabled, createTx, gameState, countdown, setCountdown]);\n\n  useEffect(() => {\n    if (!rapidFire || !enabled) {\n      setRapidFire(false);\n      return;\n    }\n\n    let intervalId: NodeJS.Timeout;\n    const timeoutId = setTimeout(() => {\n      intervalId = setInterval(() => {\n        makeTransaction();\n      }, 30);\n    }, 300);\n\n    return () => {\n      clearTimeout(timeoutId);\n      clearInterval(intervalId);\n    };\n  }, [rapidFire, enabled, makeTransaction]);\n\n  useEffect(() => {\n    const testMode = new URLSearchParams(window.location.search).has(\"test\");\n    if (!testMode) return;\n    const testInterval = window.setInterval(() => makeTransaction(), 30);\n    return () => clearInterval(testInterval);\n  }, [makeTransaction]);\n\n  useEffect(() => {\n    document.addEventListener(\"keyup\", makeTransaction);\n    return () => {\n      document.removeEventListener(\"keyup\", makeTransaction);\n    };\n  }, [makeTransaction]);\n\n  useEffect(() => {\n    setTransactions(rawTransactions);\n  }, [rawTransactions, setTransactions]);\n\n  useEffect(() => {\n    const current = scrollEl.current;\n    if (current) {\n      current.scrollTop = current.scrollHeight;\n    }\n  }, [transactions.length]);\n\n  return (\n    <div className=\"card h-100 mb-0\">\n      <div className=\"card-header\">\n        <div className=\"d-flex align-items-center\">\n          <HelpButton />\n          <span className=\"text-truncate\">Live Transaction Statuses</span>\n        </div>\n        <div className=\"text-primary d-none d-md-block\">\n          {enabled ? \"Press any key to send a transaction\" : \"Game finished\"}\n        </div>\n      </div>\n      <div className=\"card-body\">\n        <div className=\"tx-wrapper border-1 border-primary h-100 position-relative\">\n          {!transactions.length && enabled ? (\n            <div className=\"d-flex h-100 justify-content-center align-items-center p-3\">\n              <h2 className=\"text-center\">\n                Try to break Solana's network by sending as many transactions as\n                you can in {COUNTDOWN_SECS} seconds!\n              </h2>\n            </div>\n          ) : null}\n          <div ref={scrollEl} className=\"square-container\" tabIndex={0}>\n            {transactions.map((tx) => (\n              <TransactionSquare key={tx.details.signature} transaction={tx} />\n            ))}\n          </div>\n        </div>\n      </div>\n      <div className=\"card-footer\">\n        <span\n          className=\"btn btn-pink w-100 text-uppercase text-truncate touch-action-none\"\n          onContextMenu={(e) => e.preventDefault()}\n          onPointerDown={() => setRapidFire(true)}\n          onPointerUp={() => setRapidFire(false)}\n          onPointerLeave={() => setRapidFire(false)}\n          onPointerCancel={() => setRapidFire(false)}\n          onClick={enabled ? makeTransaction : resetGame}\n        >\n          <span className={`fe fe-${enabled ? \"zap\" : \"repeat\"} mr-2`}></span>\n          {enabled ? \"Send new transactions\" : \"Play again\"}\n        </span>\n      </div>\n    </div>\n  );\n}\n\nfunction Legend({ show }: { show: boolean }) {\n  if (!show) return null;\n  return (\n    <div className=\"popover bs-popover-bottom right show\">\n      <div className=\"arrow\" />\n      <div className=\"popover-body\">\n        <div className=\"d-flex flex-column\">\n          <div className=\"d-flex align-items-center mb-3\">\n            <div className=\"btn square legend slideInRight btn-dark mr-2\" />\n            <span>Pending transaction</span>\n          </div>\n\n          <div className=\"d-flex align-items-center mb-3\">\n            <div className=\"btn square legend slideInRight btn-primary mr-2\" />\n            <span>Confirmed transaction</span>\n          </div>\n\n          <div className=\"d-flex align-items-center\">\n            <div className=\"btn square legend slideInRight btn-danger mr-2\" />\n            <span>Failed transaction</span>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nfunction HelpButton() {\n  const [show, setShow] = React.useState(false);\n\n  return (\n    <div\n      className=\"popover-container c-pointer mr-3\"\n      onClick={() => setShow(true)}\n      onMouseOver={() => setShow(true)}\n      onMouseOut={() => setShow(false)}\n    >\n      <span className=\"fe fe-help-circle\"></span>\n      <Legend show={show} />\n    </div>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}