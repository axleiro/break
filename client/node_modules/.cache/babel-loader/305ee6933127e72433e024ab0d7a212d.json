{"ast":null,"code":"import _objectSpread from\"/Users/jstarry/Workspace/solana/break/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Users/jstarry/Workspace/solana/break/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React from\"react\";import{Link}from\"react-router-dom\";import{useDebounceCallback}from\"@react-hook/debounce\";import{useServer,serverName,useClusterModal,SERVERS,DEFAULT_SERVER,useCustomUrl}from\"../providers/server\";import{useRpcUrlState}from\"providers/rpc\";import{useConfig}from\"providers/server/http\";function ClusterModal(){var _useClusterModal=useClusterModal(),_useClusterModal2=_slicedToArray(_useClusterModal,2),show=_useClusterModal2[0],setShow=_useClusterModal2[1];var onClose=function onClose(){return setShow(false);};var _useServer=useServer(),server=_useServer.server;return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"modal fade fixed-right\".concat(show?\" show\":\"\"),onClick:onClose},/*#__PURE__*/React.createElement(\"div\",{className:\"modal-dialog modal-dialog-vertical\"},/*#__PURE__*/React.createElement(\"div\",{className:\"modal-content\"},/*#__PURE__*/React.createElement(\"div\",{className:\"modal-body\",onClick:function onClick(e){return e.stopPropagation();}},/*#__PURE__*/React.createElement(\"span\",{className:\"c-pointer\",onClick:onClose},\"\\xD7\"),/*#__PURE__*/React.createElement(\"h2\",{className:\"text-center mb-4 mt-4\"},\"Choose a Cluster\"),/*#__PURE__*/React.createElement(ClusterToggle,null),/*#__PURE__*/React.createElement(\"h2\",{className:\"text-center mb-4 mt-5\"},\"Override \",serverName(server),\" RPC\"),/*#__PURE__*/React.createElement(CustomRpcInput,null))))));}function CustomRpcInput(){var _useConfig;var _useRpcUrlState=useRpcUrlState(),_useRpcUrlState2=_slicedToArray(_useRpcUrlState,2),rpcUrl=_useRpcUrlState2[0],setRpcUrl=_useRpcUrlState2[1];var _React$useState=React.useState(false),_React$useState2=_slicedToArray(_React$useState,2),editing=_React$useState2[0],setEditing=_React$useState2[1];var configRpcUrl=(_useConfig=useConfig())===null||_useConfig===void 0?void 0:_useConfig.rpcUrl;var active=configRpcUrl!==rpcUrl;var customClass=function customClass(prefix){return active?\"\".concat(prefix,\"-info\"):\"\";};var onUrlInput=useDebounceCallback(function(url){if(url.length>0){setRpcUrl(url);}else if(configRpcUrl){setRpcUrl(configRpcUrl);}},500);var defaultValue=active?rpcUrl:\"\";var inputTextClass=editing?\"\":\"text-muted\";return/*#__PURE__*/React.createElement(\"input\",{type:\"text\",defaultValue:defaultValue,placeholder:\"http://127.0.0.1:8899\",className:\"form-control form-control-prepended b-black \".concat(inputTextClass,\" \").concat(customClass(\"border\")),onFocus:function onFocus(){return setEditing(true);},onBlur:function onBlur(){return setEditing(false);},onInput:function onInput(e){return onUrlInput(e.currentTarget.value);}});}function CustomClusterInput(){var _useCustomUrl=useCustomUrl(),_useCustomUrl2=_slicedToArray(_useCustomUrl,2),customUrl=_useCustomUrl2[0],setCustomUrl=_useCustomUrl2[1];var _React$useState3=React.useState(false),_React$useState4=_slicedToArray(_React$useState3,2),editing=_React$useState4[0],setEditing=_React$useState4[1];var onUrlInput=useDebounceCallback(function(url){setCustomUrl(url);},500);var inputTextClass=editing?\"\":\"text-muted\";return/*#__PURE__*/React.createElement(\"input\",{type:\"text\",defaultValue:customUrl,className:\"form-control form-control-prepended b-black \".concat(inputTextClass),onFocus:function onFocus(){return setEditing(true);},onBlur:function onBlur(){return setEditing(false);},onInput:function onInput(e){return onUrlInput(e.currentTarget.value);}});}function ClusterToggle(){var _useServer2=useServer(),server=_useServer2.server;return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"btn-group-toggle d-flex flex-wrap mb-4\"},SERVERS.map(function(next){var active=next===server;var btnClass=active?\"active btn-dark border-info text-white\":\"btn-dark\";var clusterLocation=function clusterLocation(location){var params=new URLSearchParams(location.search);if(next!==DEFAULT_SERVER){params.set(\"cluster\",next);}else{params.delete(\"cluster\");}return _objectSpread(_objectSpread({},location),{},{search:params.toString()});};return/*#__PURE__*/React.createElement(Link,{key:next,className:\"btn text-center col-12 mb-3 \".concat(btnClass),to:clusterLocation},serverName(next));})),server===\"custom\"&&/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"h2\",{className:\"text-center mb-4 mt-4\"},\"Break Server URL\"),/*#__PURE__*/React.createElement(CustomClusterInput,null)));}export default ClusterModal;","map":{"version":3,"sources":["/Users/jstarry/Workspace/solana/break/client/src/components/ClusterModal.tsx"],"names":["React","Link","useDebounceCallback","useServer","serverName","useClusterModal","SERVERS","DEFAULT_SERVER","useCustomUrl","useRpcUrlState","useConfig","ClusterModal","show","setShow","onClose","server","e","stopPropagation","CustomRpcInput","rpcUrl","setRpcUrl","useState","editing","setEditing","configRpcUrl","active","customClass","prefix","onUrlInput","url","length","defaultValue","inputTextClass","currentTarget","value","CustomClusterInput","customUrl","setCustomUrl","ClusterToggle","map","next","btnClass","clusterLocation","location","params","URLSearchParams","search","set","delete","toString"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport { Link } from \"react-router-dom\";\nimport { useDebounceCallback } from \"@react-hook/debounce\";\nimport { Location } from \"history\";\nimport {\n  useServer,\n  serverName,\n  useClusterModal,\n  SERVERS,\n  DEFAULT_SERVER,\n  useCustomUrl,\n} from \"../providers/server\";\nimport { useRpcUrlState } from \"providers/rpc\";\nimport { useConfig } from \"providers/server/http\";\n\nfunction ClusterModal() {\n  const [show, setShow] = useClusterModal();\n  const onClose = () => setShow(false);\n  const { server } = useServer();\n  return (\n    <>\n      <div\n        className={`modal fade fixed-right${show ? \" show\" : \"\"}`}\n        onClick={onClose}\n      >\n        <div className=\"modal-dialog modal-dialog-vertical\">\n          <div className=\"modal-content\">\n            <div className=\"modal-body\" onClick={(e) => e.stopPropagation()}>\n              <span className=\"c-pointer\" onClick={onClose}>\n                &times;\n              </span>\n\n              <h2 className=\"text-center mb-4 mt-4\">Choose a Cluster</h2>\n\n              <ClusterToggle />\n\n              <h2 className=\"text-center mb-4 mt-5\">\n                Override {serverName(server)} RPC\n              </h2>\n\n              <CustomRpcInput />\n            </div>\n          </div>\n        </div>\n      </div>\n    </>\n  );\n}\n\nfunction CustomRpcInput() {\n  const [rpcUrl, setRpcUrl] = useRpcUrlState();\n  const [editing, setEditing] = React.useState(false);\n  const configRpcUrl = useConfig()?.rpcUrl;\n  const active = configRpcUrl !== rpcUrl;\n\n  const customClass = (prefix: string) => (active ? `${prefix}-info` : \"\");\n  const onUrlInput = useDebounceCallback((url: string) => {\n    if (url.length > 0) {\n      setRpcUrl(url);\n    } else if (configRpcUrl) {\n      setRpcUrl(configRpcUrl);\n    }\n  }, 500);\n\n  const defaultValue = active ? rpcUrl : \"\";\n  const inputTextClass = editing ? \"\" : \"text-muted\";\n  return (\n    <input\n      type=\"text\"\n      defaultValue={defaultValue}\n      placeholder=\"http://127.0.0.1:8899\"\n      className={`form-control form-control-prepended b-black ${inputTextClass} ${customClass(\n        \"border\"\n      )}`}\n      onFocus={() => setEditing(true)}\n      onBlur={() => setEditing(false)}\n      onInput={(e) => onUrlInput(e.currentTarget.value)}\n    />\n  );\n}\n\nfunction CustomClusterInput() {\n  const [customUrl, setCustomUrl] = useCustomUrl();\n  const [editing, setEditing] = React.useState(false);\n\n  const onUrlInput = useDebounceCallback((url: string) => {\n    setCustomUrl(url);\n  }, 500);\n\n  const inputTextClass = editing ? \"\" : \"text-muted\";\n  return (\n    <input\n      type=\"text\"\n      defaultValue={customUrl}\n      className={`form-control form-control-prepended b-black ${inputTextClass}`}\n      onFocus={() => setEditing(true)}\n      onBlur={() => setEditing(false)}\n      onInput={(e) => onUrlInput(e.currentTarget.value)}\n    />\n  );\n}\n\nfunction ClusterToggle() {\n  const { server } = useServer();\n\n  return (\n    <>\n      <div className=\"btn-group-toggle d-flex flex-wrap mb-4\">\n        {SERVERS.map((next) => {\n          const active = next === server;\n          const btnClass = active\n            ? `active btn-dark border-info text-white`\n            : \"btn-dark\";\n\n          const clusterLocation = (location: Location) => {\n            const params = new URLSearchParams(location.search);\n            if (next !== DEFAULT_SERVER) {\n              params.set(\"cluster\", next);\n            } else {\n              params.delete(\"cluster\");\n            }\n            return {\n              ...location,\n              search: params.toString(),\n            };\n          };\n\n          return (\n            <Link\n              key={next}\n              className={`btn text-center col-12 mb-3 ${btnClass}`}\n              to={clusterLocation}\n            >\n              {serverName(next)}\n            </Link>\n          );\n        })}\n      </div>\n      {server === \"custom\" && (\n        <>\n          <h2 className=\"text-center mb-4 mt-4\">Break Server URL</h2>\n          <CustomClusterInput />\n        </>\n      )}\n    </>\n  );\n}\n\nexport default ClusterModal;\n"]},"metadata":{},"sourceType":"module"}