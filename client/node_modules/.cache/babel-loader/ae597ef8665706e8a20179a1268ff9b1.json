{"ast":null,"code":"import*as React from\"react\";import{useSelectTransaction,useSelectedTransaction}from\"providers/transactions/selected\";import{useClusterParam}from\"providers/server/http\";import{useSlotTiming}from\"providers/slot\";import{timeElapsed}from\"./TxTableRow\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export function TransactionModal(){var selectedTx=useSelectedTransaction();var selectTx=useSelectTransaction();var onClose=function onClose(){return selectTx(undefined);};var show=!!selectedTx;var renderContent=function renderContent(){if(!selectedTx)return null;return/*#__PURE__*/_jsx(\"div\",{className:\"modal-dialog modal-dialog-centered\",children:/*#__PURE__*/_jsx(\"div\",{className:\"modal-content\",onClick:function onClick(e){return e.stopPropagation();},children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-card card mb-0\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"card-header\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"card-header-title\",children:\"Transaction Details\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"close\",onClick:onClose,children:/*#__PURE__*/_jsx(\"span\",{\"aria-hidden\":\"true\",children:\"\\xD7\"})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"card-body\",children:/*#__PURE__*/_jsx(TransactionDetails,{transaction:selectedTx})})]})})});};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"modal fade\".concat(show?\" show\":\"\"),onClick:onClose,children:renderContent()}),/*#__PURE__*/_jsx(Overlay,{show:show})]});}function Overlay(_ref){var show=_ref.show;if(show)return/*#__PURE__*/_jsx(\"div\",{className:\"modal-backdrop fade show\"});return/*#__PURE__*/_jsx(\"div\",{className:\"fade\"});}export function TransactionDetails(_ref2){var transaction=_ref2.transaction;var clusterParam=useClusterParam();var slotMetrics=useSlotTiming();var _transaction$details=transaction.details,signature=_transaction$details.signature,feeAccount=_transaction$details.feeAccount,programAccount=_transaction$details.programAccount;var explorerLink=function explorerLink(path){return\"https://explorer.solana.com/\".concat(path,\"?\").concat(clusterParam);};var feeAddress=feeAccount.toBase58();var dataAddress=programAccount.toBase58();function displaySignature(){return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex align-items-center justify-content-between mb-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"\",children:\"Signature\"}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"a\",{href:explorerLink(\"tx/\"+signature),target:\"_blank\",rel:\"noopener noreferrer\",className:\"btn btn-sm btn-white\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"fe fe-external-link mr-2\"}),\"Explorer\"]})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"d-flex mb-4\",children:/*#__PURE__*/_jsx(\"span\",{className:\"badge badge-dark overflow-hidden\",children:/*#__PURE__*/_jsx(\"h4\",{className:\"mb-0 text-truncate\",children:signature})})})]});}function displayAccounts(){return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex align-items-center justify-content-between mb-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"\",children:\"Fee Account\"}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"a\",{href:explorerLink(\"address/\"+feeAddress),target:\"_blank\",rel:\"noopener noreferrer\",className:\"btn btn-sm btn-white\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"fe fe-external-link mr-2\"}),\"Explorer\"]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex align-items-center justify-content-between mb-4 pb-4 border-bottom\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"\",children:\"Break Account\"}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"a\",{href:explorerLink(\"address/\"+dataAddress),target:\"_blank\",rel:\"noopener noreferrer\",className:\"btn btn-sm btn-white\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"fe fe-external-link mr-2\"}),\"Explorer\"]})})]})]});}function displayFinalized(){if(transaction.status===\"success\"){if(transaction.pending){return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"spinner-grow spinner-grow-sm mr-2\"}),\"Finalizing\"]});}else{return/*#__PURE__*/_jsx(\"span\",{className:\"text-success\",children:\"Finalized\"});}}else{return\"N/A\";}}function displayConfTime(){if(transaction.status===\"timeout\"){return/*#__PURE__*/_jsx(\"span\",{className:\"text-warning\",children:\"Timed out\"});}if(transaction.status===\"success\"){var subscribed=transaction.timing.subscribed;if(subscribed!==undefined&&transaction.slot.landed!==undefined){var slotTiming=slotMetrics.current.get(transaction.slot.landed);var confirmed=slotTiming===null||slotTiming===void 0?void 0:slotTiming.confirmed;var confTime=timeElapsed(subscribed,confirmed);if(confTime){return/*#__PURE__*/_jsxs(\"span\",{className:\"text-success\",children:[confTime,\" sec\"]});}}}return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"spinner-grow spinner-grow-sm mr-2\"}),\"Processing\"]});}return/*#__PURE__*/_jsxs(_Fragment,{children:[displaySignature(),displayAccounts(),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between mb-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"\",children:\"Confirmation Time\"}),displayConfTime()]}),transaction.status===\"success\"&&/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between mb-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"\",children:\"Confirmed Block\"}),transaction.slot.landed]}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"\",children:\"Finalization Status\"}),displayFinalized()]})]});}","map":{"version":3,"sources":["/Users/jstarry/Workspace/solana/break/client/src/components/TxModal.tsx"],"names":["React","useSelectTransaction","useSelectedTransaction","useClusterParam","useSlotTiming","timeElapsed","TransactionModal","selectedTx","selectTx","onClose","undefined","show","renderContent","e","stopPropagation","Overlay","TransactionDetails","transaction","clusterParam","slotMetrics","details","signature","feeAccount","programAccount","explorerLink","path","feeAddress","toBase58","dataAddress","displaySignature","displayAccounts","displayFinalized","status","pending","displayConfTime","subscribed","timing","slot","landed","slotTiming","current","get","confirmed","confTime"],"mappings":"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","sourcesContent":["import * as React from \"react\";\nimport { TransactionState } from \"providers/transactions\";\nimport {\n  useSelectTransaction,\n  useSelectedTransaction,\n} from \"providers/transactions/selected\";\nimport { useClusterParam } from \"providers/server/http\";\nimport { useSlotTiming } from \"providers/slot\";\nimport { timeElapsed } from \"./TxTableRow\";\n\nexport function TransactionModal() {\n  const selectedTx = useSelectedTransaction();\n  const selectTx = useSelectTransaction();\n  const onClose = () => selectTx(undefined);\n  const show = !!selectedTx;\n\n  const renderContent = () => {\n    if (!selectedTx) return null;\n\n    return (\n      <div className=\"modal-dialog modal-dialog-centered\">\n        <div className=\"modal-content\" onClick={(e) => e.stopPropagation()}>\n          <div className=\"modal-card card mb-0\">\n            <div className=\"card-header\">\n              <h4 className=\"card-header-title\">Transaction Details</h4>\n\n              <button type=\"button\" className=\"close\" onClick={onClose}>\n                <span aria-hidden=\"true\">&times;</span>\n              </button>\n            </div>\n\n            <div className=\"card-body\">\n              <TransactionDetails transaction={selectedTx} />\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  };\n\n  return (\n    <>\n      <div className={`modal fade${show ? \" show\" : \"\"}`} onClick={onClose}>\n        {renderContent()}\n      </div>\n      <Overlay show={show} />\n    </>\n  );\n}\n\nfunction Overlay({ show }: { show: boolean }) {\n  if (show) return <div className=\"modal-backdrop fade show\"></div>;\n  return <div className=\"fade\"></div>;\n}\n\nexport function TransactionDetails({\n  transaction,\n}: {\n  transaction: TransactionState;\n}) {\n  const clusterParam = useClusterParam();\n  const slotMetrics = useSlotTiming();\n  const { signature, feeAccount, programAccount } = transaction.details;\n  const explorerLink = (path: string) =>\n    `https://explorer.solana.com/${path}?${clusterParam}`;\n  const feeAddress = feeAccount.toBase58();\n  const dataAddress = programAccount.toBase58();\n\n  function displaySignature() {\n    return (\n      <>\n        <div className=\"d-flex align-items-center justify-content-between mb-4\">\n          <div className=\"\">Signature</div>\n          <div>\n            <a\n              href={explorerLink(\"tx/\" + signature)}\n              target=\"_blank\"\n              rel=\"noopener noreferrer\"\n              className=\"btn btn-sm btn-white\"\n            >\n              <span className=\"fe fe-external-link mr-2\"></span>\n              Explorer\n            </a>\n          </div>\n        </div>\n        <div className=\"d-flex mb-4\">\n          <span className=\"badge badge-dark overflow-hidden\">\n            <h4 className=\"mb-0 text-truncate\">{signature}</h4>\n          </span>\n        </div>\n      </>\n    );\n  }\n\n  function displayAccounts() {\n    return (\n      <>\n        <div className=\"d-flex align-items-center justify-content-between mb-4\">\n          <div className=\"\">Fee Account</div>\n          <div>\n            <a\n              href={explorerLink(\"address/\" + feeAddress)}\n              target=\"_blank\"\n              rel=\"noopener noreferrer\"\n              className=\"btn btn-sm btn-white\"\n            >\n              <span className=\"fe fe-external-link mr-2\"></span>\n              Explorer\n            </a>\n          </div>\n        </div>\n\n        <div className=\"d-flex align-items-center justify-content-between mb-4 pb-4 border-bottom\">\n          <div className=\"\">Break Account</div>\n          <div>\n            <a\n              href={explorerLink(\"address/\" + dataAddress)}\n              target=\"_blank\"\n              rel=\"noopener noreferrer\"\n              className=\"btn btn-sm btn-white\"\n            >\n              <span className=\"fe fe-external-link mr-2\"></span>\n              Explorer\n            </a>\n          </div>\n        </div>\n      </>\n    );\n  }\n\n  function displayFinalized() {\n    if (transaction.status === \"success\") {\n      if (transaction.pending) {\n        return (\n          <div>\n            <span className=\"spinner-grow spinner-grow-sm mr-2\"></span>\n            Finalizing\n          </div>\n        );\n      } else {\n        return <span className=\"text-success\">Finalized</span>;\n      }\n    } else {\n      return \"N/A\";\n    }\n  }\n\n  function displayConfTime() {\n    if (transaction.status === \"timeout\") {\n      return <span className=\"text-warning\">Timed out</span>;\n    }\n    if (transaction.status === \"success\") {\n      const subscribed = transaction.timing.subscribed;\n      if (subscribed !== undefined && transaction.slot.landed !== undefined) {\n        const slotTiming = slotMetrics.current.get(transaction.slot.landed);\n        const confirmed = slotTiming?.confirmed;\n        const confTime = timeElapsed(subscribed, confirmed);\n        if (confTime) {\n          return <span className=\"text-success\">{confTime} sec</span>;\n        }\n      }\n    }\n    return (\n      <div>\n        <span className=\"spinner-grow spinner-grow-sm mr-2\"></span>\n        Processing\n      </div>\n    );\n  }\n\n  return (\n    <>\n      {displaySignature()}\n      {displayAccounts()}\n      <div className=\"d-flex justify-content-between mb-4\">\n        <div className=\"\">Confirmation Time</div>\n        {displayConfTime()}\n      </div>\n      {transaction.status === \"success\" && (\n        <div className=\"d-flex justify-content-between mb-4\">\n          <div className=\"\">Confirmed Block</div>\n          {transaction.slot.landed}\n        </div>\n      )}\n      <div className=\"d-flex justify-content-between\">\n        <div className=\"\">Finalization Status</div>\n        {displayFinalized()}\n      </div>\n    </>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}