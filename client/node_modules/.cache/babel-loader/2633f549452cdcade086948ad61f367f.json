{"ast":null,"code":"module.exports = function (e) {\n  var t = {};\n\n  function r(n) {\n    if (t[n]) return t[n].exports;\n    var o = t[n] = {\n      i: n,\n      l: !1,\n      exports: {}\n    };\n    return e[n].call(o.exports, o, o.exports, r), o.l = !0, o.exports;\n  }\n\n  return r.m = e, r.c = t, r.d = function (e, t, n) {\n    r.o(e, t) || Object.defineProperty(e, t, {\n      enumerable: !0,\n      get: n\n    });\n  }, r.r = function (e) {\n    \"undefined\" != typeof Symbol && Symbol.toStringTag && Object.defineProperty(e, Symbol.toStringTag, {\n      value: \"Module\"\n    }), Object.defineProperty(e, \"__esModule\", {\n      value: !0\n    });\n  }, r.t = function (e, t) {\n    if (1 & t && (e = r(e)), 8 & t) return e;\n    if (4 & t && \"object\" == typeof e && e && e.__esModule) return e;\n    var n = Object.create(null);\n    if (r.r(n), Object.defineProperty(n, \"default\", {\n      enumerable: !0,\n      value: e\n    }), 2 & t && \"string\" != typeof e) for (var o in e) {\n      r.d(n, o, function (t) {\n        return e[t];\n      }.bind(null, o));\n    }\n    return n;\n  }, r.n = function (e) {\n    var t = e && e.__esModule ? function () {\n      return e.default;\n    } : function () {\n      return e;\n    };\n    return r.d(t, \"a\", t), t;\n  }, r.o = function (e, t) {\n    return Object.prototype.hasOwnProperty.call(e, t);\n  }, r.p = \"\", r(r.s = 15);\n}([function (e, t) {\n  e.exports = require(\"bn.js\");\n}, function (e, t) {\n  e.exports = require(\"@babel/runtime/regenerator\");\n}, function (e, t) {\n  e.exports = require(\"@toruslabs/http-helpers\");\n}, function (e, t) {\n  e.exports = require(\"web3-utils\");\n}, function (e, t) {\n  e.exports = require(\"@babel/runtime/helpers/asyncToGenerator\");\n}, function (e, t) {\n  e.exports = require(\"@toruslabs/eccrypto\");\n}, function (e, t) {\n  e.exports = require(\"@babel/runtime/helpers/defineProperty\");\n}, function (e, t) {\n  e.exports = require(\"@babel/runtime/helpers/toConsumableArray\");\n}, function (e, t) {\n  e.exports = require(\"@babel/runtime/helpers/typeof\");\n}, function (e, t) {\n  e.exports = require(\"@babel/runtime/helpers/classCallCheck\");\n}, function (e, t) {\n  e.exports = require(\"@babel/runtime/helpers/createClass\");\n}, function (e, t) {\n  e.exports = require(\"elliptic\");\n}, function (e, t) {\n  e.exports = require(\"memory-cache\");\n}, function (e, t) {\n  e.exports = require(\"loglevel\");\n}, function (e, t) {\n  e.exports = require(\"json-stable-stringify\");\n}, function (e, t, r) {\n  \"use strict\";\n\n  r.r(t);\n\n  var n = r(1),\n      o = r.n(n),\n      u = r(6),\n      a = r.n(u),\n      i = r(8),\n      c = r.n(i),\n      s = r(4),\n      l = r.n(s),\n      f = r(9),\n      p = r.n(f),\n      h = r(10),\n      b = r.n(h),\n      d = r(5),\n      g = r(2),\n      v = r(0),\n      m = r.n(v),\n      y = r(11),\n      k = r(12),\n      x = r.n(k),\n      O = r(3),\n      w = r(13),\n      j = r.n(w).a.getLogger(\"torus.js\"),\n      P = function P(e, t) {\n    return new Promise(function (r, n) {\n      var o,\n          u = 0,\n          a = {\n        resolved: !1\n      },\n          i = new Array(e.length).fill(void 0),\n          c = new Array(e.length).fill(void 0);\n      e.forEach(function (s, l) {\n        s.then(function (e) {\n          c[l] = e;\n        }).catch(function (e) {\n          i[l] = e;\n        }).finally(function () {\n          a.resolved || t(c.slice(0), a).then(function (e) {\n            a.resolved = !0, r(e);\n          }).catch(function (e) {\n            o = e;\n          }).finally(function (t) {\n            (u += 1) === e.length && n(new Error(\"Unable to resolve enough promises, errors: \".concat(JSON.stringify(i), \", responses: \").concat(JSON.stringify(c), \", predicate: \").concat(o.message || o)));\n          });\n        });\n      });\n    });\n  },\n      S = r(7),\n      _ = r.n(S),\n      A = r(14),\n      q = r.n(A);\n\n  function K(e, t) {\n    var r = Object.keys(e);\n\n    if (Object.getOwnPropertySymbols) {\n      var n = Object.getOwnPropertySymbols(e);\n      t && (n = n.filter(function (t) {\n        return Object.getOwnPropertyDescriptor(e, t).enumerable;\n      })), r.push.apply(r, n);\n    }\n\n    return r;\n  }\n\n  function C(e) {\n    for (var t = 1; t < arguments.length; t++) {\n      var r = null != arguments[t] ? arguments[t] : {};\n      t % 2 ? K(Object(r), !0).forEach(function (t) {\n        a()(e, t, r[t]);\n      }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(r)) : K(Object(r)).forEach(function (t) {\n        Object.defineProperty(e, t, Object.getOwnPropertyDescriptor(r, t));\n      });\n    }\n\n    return e;\n  }\n\n  var E = function e(t, r) {\n    var n = t;\n    if (\"number\" == typeof n && (n = Array.from({\n      length: n\n    }, function (e, t) {\n      return t;\n    })), r > n.length || r <= 0) return [];\n    if (r === n.length) return [n];\n    if (1 === r) return n.reduce(function (e, t) {\n      return [].concat(_()(e), [[t]]);\n    }, []);\n\n    for (var o = [], u = [], a = 0; a <= n.length - r + 1; a += 1) {\n      u = e(n.slice(a + 1), r - 1);\n\n      for (var i = 0; i < u.length; i += 1) {\n        o.push([n[a]].concat(_()(u[i])));\n      }\n    }\n\n    return o;\n  },\n      M = function M(e, t) {\n    for (var r = {}, n = 0; n < e.length; n += 1) {\n      var o = q()(e[n]);\n      if (r[o] = r[o] ? r[o] + 1 : 1, r[o] === t) return e[n];\n    }\n  },\n      R = function R(e, t, r) {\n    var n = e.map(function (e) {\n      return Object(g.post)(e, Object(g.generateJsonRPCObject)(\"VerifierLookupRequest\", {\n        verifier: t,\n        verifier_id: r.toString()\n      })).catch(function (e) {});\n    });\n    return P(n, function (t) {\n      var r = t.filter(function (e) {\n        return e;\n      }),\n          n = M(r.map(function (e) {\n        return e && e.error;\n      }), 1 + ~~(e.length / 2)),\n          o = M(r.map(function (e) {\n        return e && e.result;\n      }), 1 + ~~(e.length / 2));\n      return o || n ? Promise.resolve({\n        keyResult: o,\n        errorResult: n\n      }) : Promise.reject(new Error(\"invalid\"));\n    }).catch(function (e) {});\n  },\n      D = function e(t, r, n, o, u, a) {\n    var i, c;\n    if (void 0 === n ? (i = Math.floor(Math.random() * t.length), c = i) : i = n % t.length, i === o) throw new Error(\"Looped through all\");\n    void 0 !== o && (c = o);\n    var s = Object(g.generateJsonRPCObject)(\"KeyAssign\", {\n      verifier: u,\n      verifier_id: a.toString()\n    });\n    return Object(g.post)(\"https://signer.tor.us/api/sign\", s, {\n      headers: {\n        pubKeyX: r[i].X,\n        pubKeyY: r[i].Y\n      }\n    }, {\n      useAPIKey: !0\n    }).then(function (n) {\n      return Object(g.post)(t[i], C(C({}, s), n), {\n        headers: {\n          \"Content-Type\": \"application/json; charset=utf-8\"\n        }\n      }).catch(function (n) {\n        return e(t, r, i + 1, c, u, a);\n      });\n    });\n  };\n\n  function I(e, t) {\n    var r = Object.keys(e);\n\n    if (Object.getOwnPropertySymbols) {\n      var n = Object.getOwnPropertySymbols(e);\n      t && (n = n.filter(function (t) {\n        return Object.getOwnPropertyDescriptor(e, t).enumerable;\n      })), r.push.apply(r, n);\n    }\n\n    return r;\n  }\n\n  function X(e) {\n    for (var t = 1; t < arguments.length; t++) {\n      var r = null != arguments[t] ? arguments[t] : {};\n      t % 2 ? I(Object(r), !0).forEach(function (t) {\n        a()(e, t, r[t]);\n      }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(r)) : I(Object(r)).forEach(function (t) {\n        Object.defineProperty(e, t, Object.getOwnPropertyDescriptor(r, t));\n      });\n    }\n\n    return e;\n  }\n\n  var Y = function () {\n    function e() {\n      var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {},\n          r = t.enableLogging,\n          n = void 0 !== r && r,\n          o = t.metadataHost,\n          u = void 0 === o ? \"https://metadata.tor.us\" : o,\n          a = t.allowHost,\n          i = void 0 === a ? \"https://signer.tor.us/api/allow\" : a;\n      p()(this, e), this.ec = new y.ec(\"secp256k1\"), this.metadataHost = u, this.allowHost = i, this.metadataCache = x.a, j.setDefaultLevel(\"DEBUG\"), n || j.disableAll(), this.metadataLock = {};\n    }\n\n    var t, r, n;\n    return b()(e, [{\n      key: \"retrieveShares\",\n      value: (n = l()(o.a.mark(function e(t, r, n, u, a) {\n        var i,\n            s,\n            f,\n            p,\n            h,\n            b,\n            v,\n            y,\n            k = this;\n        return o.a.wrap(function (e) {\n          for (;;) {\n            switch (e.prev = e.next) {\n              case 0:\n                return i = [], e.next = 3, Object(g.get)(this.allowHost, {}, {\n                  useAPIKey: !0\n                });\n\n              case 3:\n                for (s = Object(d.generatePrivate)(), f = Object(d.getPublic)(s).toString(\"hex\"), p = f.slice(2, 66), h = f.slice(66), b = Object(O.keccak256)(a), v = 0; v < t.length; v += 1) {\n                  y = Object(g.post)(t[v], Object(g.generateJsonRPCObject)(\"CommitmentRequest\", {\n                    messageprefix: \"mug00\",\n                    tokencommitment: b.slice(2),\n                    temppubx: p,\n                    temppuby: h,\n                    verifieridentifier: n\n                  })).catch(function (e) {\n                    return j.debug(\"commitment\", e);\n                  }), i.push(y);\n                }\n\n                return e.abrupt(\"return\", P(i, function (e) {\n                  return e.filter(function (e) {\n                    return !(!e || \"object\" !== c()(e) || e.error);\n                  }).length >= 3 * ~~(t.length / 4) + 1 ? Promise.resolve(e) : Promise.reject(new Error(\"invalid\"));\n                }).then(function (e) {\n                  for (var i = [], c = [], f = 0; f < e.length; f += 1) {\n                    e[f] && c.push(e[f].result);\n                  }\n\n                  for (var p = 0; p < t.length; p += 1) {\n                    var h = Object(g.post)(t[p], Object(g.generateJsonRPCObject)(\"ShareRequest\", {\n                      encrypted: \"yes\",\n                      item: [X(X({}, u), {}, {\n                        idtoken: a,\n                        nodesignatures: c,\n                        verifieridentifier: n\n                      })]\n                    })).catch(function (e) {\n                      return j.debug(\"share req\", e);\n                    });\n                    i.push(h);\n                  }\n\n                  return P(i, function () {\n                    var e = l()(o.a.mark(function e(n, u) {\n                      var a, i, c, l, f, p, h, b, g, v, y, x, O, w;\n                      return o.a.wrap(function (e) {\n                        for (;;) {\n                          switch (e.prev = e.next) {\n                            case 0:\n                              if (a = n.filter(function (e) {\n                                return e;\n                              }), i = M(n.map(function (e) {\n                                return e && e.result && e.result.keys[0].PublicKey;\n                              }), 1 + ~~(t.length / 2)), !(a.length >= 1 + ~~(t.length / 2) && i)) {\n                                e.next = 32;\n                                break;\n                              }\n\n                              for (c = [], l = [], f = 0; f < n.length; f += 1) {\n                                n[f] && n[f].result && n[f].result.keys && n[f].result.keys.length > 0 ? (n[f].result.keys.sort(function (e, t) {\n                                  return new m.a(e.Index, 16).cmp(new m.a(t.Index, 16));\n                                }), n[f].result.keys[0].Metadata ? (p = {\n                                  ephemPublicKey: Buffer.from(n[f].result.keys[0].Metadata.ephemPublicKey, \"hex\"),\n                                  iv: Buffer.from(n[f].result.keys[0].Metadata.iv, \"hex\"),\n                                  mac: Buffer.from(n[f].result.keys[0].Metadata.mac, \"hex\"),\n                                  mode: Buffer.from(n[f].result.keys[0].Metadata.mode, \"hex\")\n                                }, c.push(Object(d.decrypt)(s, X(X({}, p), {}, {\n                                  ciphertext: Buffer.from(atob(n[f].result.keys[0].Share).padStart(64, \"0\"), \"hex\")\n                                })).catch(function (e) {\n                                  return j.debug(\"share decryption\", e);\n                                }))) : c.push(Promise.resolve(Buffer.from(n[f].result.keys[0].Share.padStart(64, \"0\"), \"hex\")))) : c.push(Promise.resolve(void 0)), l.push(new m.a(r[f], 16));\n                              }\n\n                              return e.next = 8, Promise.all(c);\n\n                            case 8:\n                              if (h = e.sent, !u.resolved) {\n                                e.next = 11;\n                                break;\n                              }\n\n                              return e.abrupt(\"return\", void 0);\n\n                            case 11:\n                              b = h.reduce(function (e, t, r) {\n                                return t && e.push({\n                                  index: l[r],\n                                  value: new m.a(t)\n                                }), e;\n                              }, []), g = E(b.length, 1 + ~~(t.length / 2)), y = function y(e) {\n                                var t = g[e],\n                                    r = b.filter(function (e, r) {\n                                  return t.includes(r);\n                                }),\n                                    n = r.map(function (e) {\n                                  return e.value;\n                                }),\n                                    o = r.map(function (e) {\n                                  return e.index;\n                                }),\n                                    u = k.lagrangeInterpolation(n, o),\n                                    a = Object(d.getPublic)(Buffer.from(u.toString(16, 64), \"hex\")).toString(\"hex\"),\n                                    c = a.slice(2, 66),\n                                    s = a.slice(66);\n                                if (0 === new m.a(c, 16).cmp(new m.a(i.X, 16)) && 0 === new m.a(s, 16).cmp(new m.a(i.Y, 16))) return v = u, \"break\";\n                              }, x = 0;\n\n                            case 15:\n                              if (!(x < g.length)) {\n                                e.next = 22;\n                                break;\n                              }\n\n                              if (\"break\" !== y(x)) {\n                                e.next = 19;\n                                break;\n                              }\n\n                              return e.abrupt(\"break\", 22);\n\n                            case 19:\n                              x += 1, e.next = 15;\n                              break;\n\n                            case 22:\n                              if (void 0 !== v) {\n                                e.next = 24;\n                                break;\n                              }\n\n                              throw new Error(\"could not derive private key\");\n\n                            case 24:\n                              return e.next = 26, k.getMetadata({\n                                pub_key_X: i.X,\n                                pub_key_Y: i.Y\n                              });\n\n                            case 26:\n                              if (O = e.sent, !u.resolved) {\n                                e.next = 29;\n                                break;\n                              }\n\n                              return e.abrupt(\"return\", void 0);\n\n                            case 29:\n                              return v = v.add(O).umod(k.ec.curve.n), w = k.generateAddressFromPrivKey(v), e.abrupt(\"return\", {\n                                ethAddress: w,\n                                privKey: v.toString(\"hex\", 64)\n                              });\n\n                            case 32:\n                              throw new Error(\"invalid\");\n\n                            case 33:\n                            case \"end\":\n                              return e.stop();\n                          }\n                        }\n                      }, e);\n                    }));\n                    return function (t, r) {\n                      return e.apply(this, arguments);\n                    };\n                  }());\n                }));\n\n              case 10:\n              case \"end\":\n                return e.stop();\n            }\n          }\n        }, e, this);\n      })), function (e, t, r, o, u) {\n        return n.apply(this, arguments);\n      })\n    }, {\n      key: \"getMetadata\",\n      value: (r = l()(o.a.mark(function e(t, r) {\n        var n,\n            u,\n            a,\n            i,\n            c = this;\n        return o.a.wrap(function (e) {\n          for (;;) {\n            switch (e.prev = e.next) {\n              case 0:\n                if (e.prev = 0, u = JSON.stringify(t), null === this.metadataLock[u]) {\n                  e.next = 7;\n                  break;\n                }\n\n                return e.next = 5, this.metadataLock[u];\n\n              case 5:\n                e.next = 8;\n                break;\n\n              case 7:\n                this.metadataLock[u] = new Promise(function (e) {\n                  n = function n() {\n                    c.metadataLock[u] = null, e();\n                  };\n                });\n\n              case 8:\n                if (null === (a = this.metadataCache.get(u))) {\n                  e.next = 12;\n                  break;\n                }\n\n                return n && n(), e.abrupt(\"return\", a);\n\n              case 12:\n                return e.next = 14, Object(g.post)(\"\".concat(this.metadataHost, \"/get\"), t, r, {\n                  useAPIKey: !0\n                });\n\n              case 14:\n                if ((i = e.sent) && i.message) {\n                  e.next = 19;\n                  break;\n                }\n\n                return this.metadataCache.put(u, new m.a(0), 6e4), n && n(), e.abrupt(\"return\", new m.a(0));\n\n              case 19:\n                return this.metadataCache.put(u, new m.a(i.message, 16), 6e4), e.abrupt(\"return\", new m.a(i.message, 16));\n\n              case 23:\n                return e.prev = 23, e.t0 = e.catch(0), j.error(e.t0), n && n(), e.abrupt(\"return\", new m.a(0));\n\n              case 28:\n              case \"end\":\n                return e.stop();\n            }\n          }\n        }, e, this, [[0, 23]]);\n      })), function (e, t) {\n        return r.apply(this, arguments);\n      })\n    }, {\n      key: \"generateMetadataParams\",\n      value: function value(e, t) {\n        var r = this.ec.keyFromPrivate(t.toString(\"hex\", 64)),\n            n = {\n          data: e,\n          timestamp: new m.a(~~(Date.now() / 1e3)).toString(16)\n        },\n            o = r.sign(Object(O.keccak256)(JSON.stringify(n)).slice(2));\n        return {\n          pub_key_X: r.getPublic().getX().toString(\"hex\"),\n          pub_key_Y: r.getPublic().getY().toString(\"hex\"),\n          set_data: n,\n          signature: Buffer.from(o.r.toString(16, 64) + o.s.toString(16, 64) + new m.a(o.v).toString(16, 2), \"hex\").toString(\"base64\")\n        };\n      }\n    }, {\n      key: \"setMetadata\",\n      value: (t = l()(o.a.mark(function e(t, r) {\n        var n;\n        return o.a.wrap(function (e) {\n          for (;;) {\n            switch (e.prev = e.next) {\n              case 0:\n                return e.prev = 0, e.next = 3, Object(g.post)(\"\".concat(this.metadataHost, \"/set\"), t, r, {\n                  useAPIKey: !0\n                });\n\n              case 3:\n                return n = e.sent, e.abrupt(\"return\", n.message);\n\n              case 7:\n                return e.prev = 7, e.t0 = e.catch(0), j.error(e.t0), e.abrupt(\"return\", \"\");\n\n              case 11:\n              case \"end\":\n                return e.stop();\n            }\n          }\n        }, e, this, [[0, 7]]);\n      })), function (e, r) {\n        return t.apply(this, arguments);\n      })\n    }, {\n      key: \"lagrangeInterpolation\",\n      value: function value(e, t) {\n        if (e.length !== t.length) return null;\n\n        for (var r = new m.a(0), n = 0; n < e.length; n += 1) {\n          for (var o = new m.a(1), u = new m.a(1), a = 0; a < e.length; a += 1) {\n            if (n !== a) {\n              o = (o = o.mul(t[a].neg())).umod(this.ec.curve.n);\n              var i = t[n].sub(t[a]);\n              i = i.umod(this.ec.curve.n), u = u.mul(i).umod(this.ec.curve.n);\n            }\n          }\n\n          var c = o.mul(u.invm(this.ec.curve.n)).umod(this.ec.curve.n);\n          c = c.mul(e[n]).umod(this.ec.curve.n), r = r.add(c);\n        }\n\n        return r.umod(this.ec.curve.n);\n      }\n    }, {\n      key: \"generateAddressFromPrivKey\",\n      value: function value(e) {\n        var t = this.ec.keyFromPrivate(e.toString(\"hex\", 64), \"hex\").getPublic().encode(\"hex\").slice(2),\n            r = \"0x\".concat(Object(O.keccak256)(Buffer.from(t, \"hex\")).slice(26));\n        return Object(O.toChecksumAddress)(r);\n      }\n    }, {\n      key: \"generateAddressFromPubKey\",\n      value: function value(e, t) {\n        var r = this.ec.keyFromPublic({\n          x: e.toString(\"hex\", 64),\n          y: t.toString(\"hex\", 64)\n        }).getPublic().encode(\"hex\").slice(2),\n            n = \"0x\".concat(Object(O.keccak256)(Buffer.from(r, \"hex\")).slice(26));\n        return Object(O.toChecksumAddress)(n);\n      }\n    }, {\n      key: \"getPublicAddress\",\n      value: function value(e, t, r) {\n        var n = this,\n            u = r.verifier,\n            a = r.verifierId,\n            i = arguments.length > 3 && void 0 !== arguments[3] && arguments[3];\n        return R(e, u, a).then(function () {\n          var r = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {},\n              n = r.keyResult,\n              o = r.errorResult;\n          if (o && JSON.stringify(o).includes(\"Verifier + VerifierID has not yet been assigned\")) return D(e, t, void 0, void 0, u, a).then(function (t) {\n            return R(e, u, a);\n          });\n          if (n) return {\n            keyResult: n\n          };\n          throw new Error(\"node results do not match\");\n        }).then(l()(o.a.mark(function e() {\n          var t,\n              r,\n              u,\n              a,\n              c,\n              s,\n              l,\n              f,\n              p = arguments;\n          return o.a.wrap(function (e) {\n            for (;;) {\n              switch (e.prev = e.next) {\n                case 0:\n                  if (t = p.length > 0 && void 0 !== p[0] ? p[0] : {}, !(r = t.keyResult)) {\n                    e.next = 13;\n                    break;\n                  }\n\n                  return u = r.keys[0], a = u.pub_key_X, c = u.pub_key_Y, e.next = 5, n.getMetadata({\n                    pub_key_X: a,\n                    pub_key_Y: c\n                  });\n\n                case 5:\n                  if (s = e.sent, l = n.ec.keyFromPublic({\n                    x: a.toString(16),\n                    y: c.toString(16)\n                  }).getPublic().add(n.ec.keyFromPrivate(s.toString(16)).getPublic()), a = l.getX().toString(16), c = l.getY().toString(16), f = n.generateAddressFromPubKey(l.getX(), l.getY()), i) {\n                    e.next = 12;\n                    break;\n                  }\n\n                  return e.abrupt(\"return\", f);\n\n                case 12:\n                  return e.abrupt(\"return\", {\n                    address: f,\n                    X: a,\n                    Y: c\n                  });\n\n                case 13:\n                  throw new Error(\"node results do not match\");\n\n                case 14:\n                case \"end\":\n                  return e.stop();\n              }\n            }\n          }, e);\n        })));\n      }\n    }], [{\n      key: \"setAPIKey\",\n      value: function value(e) {\n        Object(g.setAPIKey)(e);\n      }\n    }, {\n      key: \"setEmbedHost\",\n      value: function value(e) {\n        Object(g.setEmbedHost)(e);\n      }\n    }]), e;\n  }();\n\n  t.default = Y;\n}]).default;","map":{"version":3,"sources":["/Users/jstarry/Workspace/solana/break/client/node_modules/@toruslabs/torus.js/dist/torusUtils.cjs.js"],"names":["module","exports","e","t","r","n","o","i","l","call","m","c","d","Object","defineProperty","enumerable","get","Symbol","toStringTag","value","__esModule","create","bind","default","prototype","hasOwnProperty","p","s","require","u","a","f","h","b","g","v","y","k","x","O","w","j","getLogger","P","Promise","resolved","Array","length","fill","forEach","then","catch","finally","slice","Error","concat","JSON","stringify","message","S","_","A","q","K","keys","getOwnPropertySymbols","filter","getOwnPropertyDescriptor","push","apply","C","arguments","getOwnPropertyDescriptors","defineProperties","E","from","reduce","M","R","map","post","generateJsonRPCObject","verifier","verifier_id","toString","error","result","resolve","keyResult","errorResult","reject","D","Math","floor","random","headers","pubKeyX","X","pubKeyY","Y","useAPIKey","I","enableLogging","metadataHost","allowHost","ec","metadataCache","setDefaultLevel","disableAll","metadataLock","key","mark","wrap","prev","next","generatePrivate","getPublic","keccak256","messageprefix","tokencommitment","temppubx","temppuby","verifieridentifier","debug","abrupt","encrypted","item","idtoken","nodesignatures","PublicKey","sort","Index","cmp","Metadata","ephemPublicKey","Buffer","iv","mac","mode","decrypt","ciphertext","atob","Share","padStart","all","sent","index","includes","lagrangeInterpolation","getMetadata","pub_key_X","pub_key_Y","add","umod","curve","generateAddressFromPrivKey","ethAddress","privKey","stop","put","t0","keyFromPrivate","data","timestamp","Date","now","sign","getX","getY","set_data","signature","mul","neg","sub","invm","encode","toChecksumAddress","keyFromPublic","verifierId","generateAddressFromPubKey","address","setAPIKey","setEmbedHost"],"mappings":"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","sourcesContent":["module.exports=function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&\"object\"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,\"default\",{enumerable:!0,value:e}),2&t&&\"string\"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,\"a\",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p=\"\",r(r.s=15)}([function(e,t){e.exports=require(\"bn.js\")},function(e,t){e.exports=require(\"@babel/runtime/regenerator\")},function(e,t){e.exports=require(\"@toruslabs/http-helpers\")},function(e,t){e.exports=require(\"web3-utils\")},function(e,t){e.exports=require(\"@babel/runtime/helpers/asyncToGenerator\")},function(e,t){e.exports=require(\"@toruslabs/eccrypto\")},function(e,t){e.exports=require(\"@babel/runtime/helpers/defineProperty\")},function(e,t){e.exports=require(\"@babel/runtime/helpers/toConsumableArray\")},function(e,t){e.exports=require(\"@babel/runtime/helpers/typeof\")},function(e,t){e.exports=require(\"@babel/runtime/helpers/classCallCheck\")},function(e,t){e.exports=require(\"@babel/runtime/helpers/createClass\")},function(e,t){e.exports=require(\"elliptic\")},function(e,t){e.exports=require(\"memory-cache\")},function(e,t){e.exports=require(\"loglevel\")},function(e,t){e.exports=require(\"json-stable-stringify\")},function(e,t,r){\"use strict\";r.r(t);var n=r(1),o=r.n(n),u=r(6),a=r.n(u),i=r(8),c=r.n(i),s=r(4),l=r.n(s),f=r(9),p=r.n(f),h=r(10),b=r.n(h),d=r(5),g=r(2),v=r(0),m=r.n(v),y=r(11),k=r(12),x=r.n(k),O=r(3),w=r(13),j=r.n(w).a.getLogger(\"torus.js\"),P=function(e,t){return new Promise((function(r,n){var o,u=0,a={resolved:!1},i=new Array(e.length).fill(void 0),c=new Array(e.length).fill(void 0);e.forEach((function(s,l){s.then((function(e){c[l]=e})).catch((function(e){i[l]=e})).finally((function(){a.resolved||t(c.slice(0),a).then((function(e){a.resolved=!0,r(e)})).catch((function(e){o=e})).finally((function(t){(u+=1)===e.length&&n(new Error(\"Unable to resolve enough promises, errors: \".concat(JSON.stringify(i),\", responses: \").concat(JSON.stringify(c),\", predicate: \").concat(o.message||o)))}))}))}))}))},S=r(7),_=r.n(S),A=r(14),q=r.n(A);function K(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function C(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?K(Object(r),!0).forEach((function(t){a()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):K(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var E=function e(t,r){var n=t;if(\"number\"==typeof n&&(n=Array.from({length:n},(function(e,t){return t}))),r>n.length||r<=0)return[];if(r===n.length)return[n];if(1===r)return n.reduce((function(e,t){return[].concat(_()(e),[[t]])}),[]);for(var o=[],u=[],a=0;a<=n.length-r+1;a+=1){u=e(n.slice(a+1),r-1);for(var i=0;i<u.length;i+=1)o.push([n[a]].concat(_()(u[i])))}return o},M=function(e,t){for(var r={},n=0;n<e.length;n+=1){var o=q()(e[n]);if(r[o]=r[o]?r[o]+1:1,r[o]===t)return e[n]}},R=function(e,t,r){var n=e.map((function(e){return Object(g.post)(e,Object(g.generateJsonRPCObject)(\"VerifierLookupRequest\",{verifier:t,verifier_id:r.toString()})).catch((function(e){}))}));return P(n,(function(t){var r=t.filter((function(e){return e})),n=M(r.map((function(e){return e&&e.error})),1+~~(e.length/2)),o=M(r.map((function(e){return e&&e.result})),1+~~(e.length/2));return o||n?Promise.resolve({keyResult:o,errorResult:n}):Promise.reject(new Error(\"invalid\"))})).catch((function(e){}))},D=function e(t,r,n,o,u,a){var i,c;if(void 0===n?(i=Math.floor(Math.random()*t.length),c=i):i=n%t.length,i===o)throw new Error(\"Looped through all\");void 0!==o&&(c=o);var s=Object(g.generateJsonRPCObject)(\"KeyAssign\",{verifier:u,verifier_id:a.toString()});return Object(g.post)(\"https://signer.tor.us/api/sign\",s,{headers:{pubKeyX:r[i].X,pubKeyY:r[i].Y}},{useAPIKey:!0}).then((function(n){return Object(g.post)(t[i],C(C({},s),n),{headers:{\"Content-Type\":\"application/json; charset=utf-8\"}}).catch((function(n){return e(t,r,i+1,c,u,a)}))}))};function I(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function X(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?I(Object(r),!0).forEach((function(t){a()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):I(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Y=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.enableLogging,n=void 0!==r&&r,o=t.metadataHost,u=void 0===o?\"https://metadata.tor.us\":o,a=t.allowHost,i=void 0===a?\"https://signer.tor.us/api/allow\":a;p()(this,e),this.ec=new y.ec(\"secp256k1\"),this.metadataHost=u,this.allowHost=i,this.metadataCache=x.a,j.setDefaultLevel(\"DEBUG\"),n||j.disableAll(),this.metadataLock={}}var t,r,n;return b()(e,[{key:\"retrieveShares\",value:(n=l()(o.a.mark((function e(t,r,n,u,a){var i,s,f,p,h,b,v,y,k=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=[],e.next=3,Object(g.get)(this.allowHost,{},{useAPIKey:!0});case 3:for(s=Object(d.generatePrivate)(),f=Object(d.getPublic)(s).toString(\"hex\"),p=f.slice(2,66),h=f.slice(66),b=Object(O.keccak256)(a),v=0;v<t.length;v+=1)y=Object(g.post)(t[v],Object(g.generateJsonRPCObject)(\"CommitmentRequest\",{messageprefix:\"mug00\",tokencommitment:b.slice(2),temppubx:p,temppuby:h,verifieridentifier:n})).catch((function(e){return j.debug(\"commitment\",e)})),i.push(y);return e.abrupt(\"return\",P(i,(function(e){return e.filter((function(e){return!(!e||\"object\"!==c()(e)||e.error)})).length>=3*~~(t.length/4)+1?Promise.resolve(e):Promise.reject(new Error(\"invalid\"))})).then((function(e){for(var i=[],c=[],f=0;f<e.length;f+=1)e[f]&&c.push(e[f].result);for(var p=0;p<t.length;p+=1){var h=Object(g.post)(t[p],Object(g.generateJsonRPCObject)(\"ShareRequest\",{encrypted:\"yes\",item:[X(X({},u),{},{idtoken:a,nodesignatures:c,verifieridentifier:n})]})).catch((function(e){return j.debug(\"share req\",e)}));i.push(h)}return P(i,function(){var e=l()(o.a.mark((function e(n,u){var a,i,c,l,f,p,h,b,g,v,y,x,O,w;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.filter((function(e){return e})),i=M(n.map((function(e){return e&&e.result&&e.result.keys[0].PublicKey})),1+~~(t.length/2)),!(a.length>=1+~~(t.length/2)&&i)){e.next=32;break}for(c=[],l=[],f=0;f<n.length;f+=1)n[f]&&n[f].result&&n[f].result.keys&&n[f].result.keys.length>0?(n[f].result.keys.sort((function(e,t){return new m.a(e.Index,16).cmp(new m.a(t.Index,16))})),n[f].result.keys[0].Metadata?(p={ephemPublicKey:Buffer.from(n[f].result.keys[0].Metadata.ephemPublicKey,\"hex\"),iv:Buffer.from(n[f].result.keys[0].Metadata.iv,\"hex\"),mac:Buffer.from(n[f].result.keys[0].Metadata.mac,\"hex\"),mode:Buffer.from(n[f].result.keys[0].Metadata.mode,\"hex\")},c.push(Object(d.decrypt)(s,X(X({},p),{},{ciphertext:Buffer.from(atob(n[f].result.keys[0].Share).padStart(64,\"0\"),\"hex\")})).catch((function(e){return j.debug(\"share decryption\",e)})))):c.push(Promise.resolve(Buffer.from(n[f].result.keys[0].Share.padStart(64,\"0\"),\"hex\")))):c.push(Promise.resolve(void 0)),l.push(new m.a(r[f],16));return e.next=8,Promise.all(c);case 8:if(h=e.sent,!u.resolved){e.next=11;break}return e.abrupt(\"return\",void 0);case 11:b=h.reduce((function(e,t,r){return t&&e.push({index:l[r],value:new m.a(t)}),e}),[]),g=E(b.length,1+~~(t.length/2)),y=function(e){var t=g[e],r=b.filter((function(e,r){return t.includes(r)})),n=r.map((function(e){return e.value})),o=r.map((function(e){return e.index})),u=k.lagrangeInterpolation(n,o),a=Object(d.getPublic)(Buffer.from(u.toString(16,64),\"hex\")).toString(\"hex\"),c=a.slice(2,66),s=a.slice(66);if(0===new m.a(c,16).cmp(new m.a(i.X,16))&&0===new m.a(s,16).cmp(new m.a(i.Y,16)))return v=u,\"break\"},x=0;case 15:if(!(x<g.length)){e.next=22;break}if(\"break\"!==y(x)){e.next=19;break}return e.abrupt(\"break\",22);case 19:x+=1,e.next=15;break;case 22:if(void 0!==v){e.next=24;break}throw new Error(\"could not derive private key\");case 24:return e.next=26,k.getMetadata({pub_key_X:i.X,pub_key_Y:i.Y});case 26:if(O=e.sent,!u.resolved){e.next=29;break}return e.abrupt(\"return\",void 0);case 29:return v=v.add(O).umod(k.ec.curve.n),w=k.generateAddressFromPrivKey(v),e.abrupt(\"return\",{ethAddress:w,privKey:v.toString(\"hex\",64)});case 32:throw new Error(\"invalid\");case 33:case\"end\":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}())})));case 10:case\"end\":return e.stop()}}),e,this)}))),function(e,t,r,o,u){return n.apply(this,arguments)})},{key:\"getMetadata\",value:(r=l()(o.a.mark((function e(t,r){var n,u,a,i,c=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,u=JSON.stringify(t),null===this.metadataLock[u]){e.next=7;break}return e.next=5,this.metadataLock[u];case 5:e.next=8;break;case 7:this.metadataLock[u]=new Promise((function(e){n=function(){c.metadataLock[u]=null,e()}}));case 8:if(null===(a=this.metadataCache.get(u))){e.next=12;break}return n&&n(),e.abrupt(\"return\",a);case 12:return e.next=14,Object(g.post)(\"\".concat(this.metadataHost,\"/get\"),t,r,{useAPIKey:!0});case 14:if((i=e.sent)&&i.message){e.next=19;break}return this.metadataCache.put(u,new m.a(0),6e4),n&&n(),e.abrupt(\"return\",new m.a(0));case 19:return this.metadataCache.put(u,new m.a(i.message,16),6e4),e.abrupt(\"return\",new m.a(i.message,16));case 23:return e.prev=23,e.t0=e.catch(0),j.error(e.t0),n&&n(),e.abrupt(\"return\",new m.a(0));case 28:case\"end\":return e.stop()}}),e,this,[[0,23]])}))),function(e,t){return r.apply(this,arguments)})},{key:\"generateMetadataParams\",value:function(e,t){var r=this.ec.keyFromPrivate(t.toString(\"hex\",64)),n={data:e,timestamp:new m.a(~~(Date.now()/1e3)).toString(16)},o=r.sign(Object(O.keccak256)(JSON.stringify(n)).slice(2));return{pub_key_X:r.getPublic().getX().toString(\"hex\"),pub_key_Y:r.getPublic().getY().toString(\"hex\"),set_data:n,signature:Buffer.from(o.r.toString(16,64)+o.s.toString(16,64)+new m.a(o.v).toString(16,2),\"hex\").toString(\"base64\")}}},{key:\"setMetadata\",value:(t=l()(o.a.mark((function e(t,r){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(g.post)(\"\".concat(this.metadataHost,\"/set\"),t,r,{useAPIKey:!0});case 3:return n=e.sent,e.abrupt(\"return\",n.message);case 7:return e.prev=7,e.t0=e.catch(0),j.error(e.t0),e.abrupt(\"return\",\"\");case 11:case\"end\":return e.stop()}}),e,this,[[0,7]])}))),function(e,r){return t.apply(this,arguments)})},{key:\"lagrangeInterpolation\",value:function(e,t){if(e.length!==t.length)return null;for(var r=new m.a(0),n=0;n<e.length;n+=1){for(var o=new m.a(1),u=new m.a(1),a=0;a<e.length;a+=1)if(n!==a){o=(o=o.mul(t[a].neg())).umod(this.ec.curve.n);var i=t[n].sub(t[a]);i=i.umod(this.ec.curve.n),u=u.mul(i).umod(this.ec.curve.n)}var c=o.mul(u.invm(this.ec.curve.n)).umod(this.ec.curve.n);c=c.mul(e[n]).umod(this.ec.curve.n),r=r.add(c)}return r.umod(this.ec.curve.n)}},{key:\"generateAddressFromPrivKey\",value:function(e){var t=this.ec.keyFromPrivate(e.toString(\"hex\",64),\"hex\").getPublic().encode(\"hex\").slice(2),r=\"0x\".concat(Object(O.keccak256)(Buffer.from(t,\"hex\")).slice(26));return Object(O.toChecksumAddress)(r)}},{key:\"generateAddressFromPubKey\",value:function(e,t){var r=this.ec.keyFromPublic({x:e.toString(\"hex\",64),y:t.toString(\"hex\",64)}).getPublic().encode(\"hex\").slice(2),n=\"0x\".concat(Object(O.keccak256)(Buffer.from(r,\"hex\")).slice(26));return Object(O.toChecksumAddress)(n)}},{key:\"getPublicAddress\",value:function(e,t,r){var n=this,u=r.verifier,a=r.verifierId,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return R(e,u,a).then((function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=r.keyResult,o=r.errorResult;if(o&&JSON.stringify(o).includes(\"Verifier + VerifierID has not yet been assigned\"))return D(e,t,void 0,void 0,u,a).then((function(t){return R(e,u,a)}));if(n)return{keyResult:n};throw new Error(\"node results do not match\")})).then(l()(o.a.mark((function e(){var t,r,u,a,c,s,l,f,p=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=p.length>0&&void 0!==p[0]?p[0]:{},!(r=t.keyResult)){e.next=13;break}return u=r.keys[0],a=u.pub_key_X,c=u.pub_key_Y,e.next=5,n.getMetadata({pub_key_X:a,pub_key_Y:c});case 5:if(s=e.sent,l=n.ec.keyFromPublic({x:a.toString(16),y:c.toString(16)}).getPublic().add(n.ec.keyFromPrivate(s.toString(16)).getPublic()),a=l.getX().toString(16),c=l.getY().toString(16),f=n.generateAddressFromPubKey(l.getX(),l.getY()),i){e.next=12;break}return e.abrupt(\"return\",f);case 12:return e.abrupt(\"return\",{address:f,X:a,Y:c});case 13:throw new Error(\"node results do not match\");case 14:case\"end\":return e.stop()}}),e)}))))}}],[{key:\"setAPIKey\",value:function(e){Object(g.setAPIKey)(e)}},{key:\"setEmbedHost\",value:function(e){Object(g.setEmbedHost)(e)}}]),e}();t.default=Y}]).default;"]},"metadata":{},"sourceType":"script"}